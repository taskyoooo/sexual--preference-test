<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æ€§åå¥½æµ‹è¯•</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
            background: #1a1a1a;
            min-height: 100vh;
            padding: 20px;
            position: relative;
        }
        body::before {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: url('leopard.jpg') repeat;
            background-size: 500px 500px;
            opacity: 0.15;
            pointer-events: none;
            z-index: 0;
        }
        body::after {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: radial-gradient(circle at 50% 50%, rgba(218, 165, 32, 0.1) 0%, transparent 70%);
            pointer-events: none;
            z-index: 0;
        }
        .container {
            max-width: 900px;
            margin: 0 auto;
            background: linear-gradient(135deg, rgba(26, 26, 26, 0.95) 0%, rgba(40, 30, 20, 0.95) 100%);
            backdrop-filter: blur(20px);
            border-radius: 30px;
            padding: 50px;
            box-shadow:
                0 0 60px rgba(218, 165, 32, 0.2),
                0 30px 90px rgba(0, 0, 0, 0.6),
                inset 0 1px 0 rgba(255, 255, 255, 0.1);
            position: relative;
            z-index: 1;
            border: 1px solid rgba(218, 165, 32, 0.3);
        }
        h1 {
            text-align: center;
            background: linear-gradient(135deg, #FFD700 0%, #FFA500 50%, #FFD700 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            margin-bottom: 8px;
            font-size: 42px;
            font-weight: 800;
            letter-spacing: 2px;
            text-shadow: 0 0 30px rgba(255, 215, 0, 0.3);
            filter: drop-shadow(0 2px 8px rgba(255, 215, 0, 0.4));
        }
        .subtitle {
            text-align: center;
            color: rgba(255, 215, 0, 0.7);
            font-size: 14px;
            margin-bottom: 30px;
            font-weight: 400;
        }
        .share-bar {
            display: flex;
            gap: 10px;
            margin-top: 24px;
        }
        .share-bar button {
            flex: 1;
            padding: 12px;
            font-size: 15px;
        }
        .btn-save {
            background: linear-gradient(135deg, #DAA520, #FFD700) !important;
            border: none !important;
            color: #000 !important;
            font-weight: 600 !important;
            box-shadow: 0 4px 15px rgba(218, 165, 32, 0.4) !important;
        }
        .btn-copy {
            background: linear-gradient(135deg, #8B4513, #A0522D) !important;
            color: #FFD700 !important;
            border: none !important;
            font-weight: 600 !important;
            box-shadow: 0 4px 15px rgba(139, 69, 19, 0.4) !important;
        }
        .result-card-wrap {
            background: linear-gradient(135deg, rgba(26, 26, 26, 0.9) 0%, rgba(40, 30, 20, 0.9) 100%);
            border-radius: 30px;
            padding: 40px 36px;
            color: #e0e0e0;
            margin-bottom: 20px;
            box-shadow:
                0 0 40px rgba(218, 165, 32, 0.2),
                0 20px 60px rgba(0, 0, 0, 0.5),
                inset 0 1px 0 rgba(255, 255, 255, 0.05);
            position: relative;
            overflow: hidden;
            border: 1px solid rgba(218, 165, 32, 0.3);
        }
        .result-card-wrap::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: url('leopard.jpg') repeat;
            background-size: 400px 400px;
            opacity: 0.08;
            z-index: 0;
        }
        .result-card-wrap::after {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 3px;
            background: linear-gradient(90deg, transparent, #FFD700, transparent);
            z-index: 2;
        }
        .result-card-wrap > * {
            position: relative;
            z-index: 1;
        }
        .result-card-wrap .result-title {
            color: #FFD700;
            font-size: 28px;
            font-weight: 700;
            text-shadow: 0 2px 10px rgba(255, 215, 0, 0.3);
        }
        .result-card-wrap .result-subtitle {
            color: rgba(255, 215, 0, 0.6);
            font-size: 14px;
        }
        .result-card-wrap .card {
            background: rgba(40, 30, 20, 0.6);
            backdrop-filter: blur(10px);
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
            border: 1px solid rgba(218, 165, 32, 0.2);
            transition: all 0.3s;
        }
        .result-card-wrap .card:hover {
            transform: translateY(-2px);
            box-shadow: 0 12px 40px rgba(218, 165, 32, 0.3);
            border-color: rgba(218, 165, 32, 0.4);
            background: rgba(40, 30, 20, 0.8);
        }
        .result-card-wrap .card-title {
            color: #FFD700;
            font-weight: 600;
        }
        .result-card-wrap .card-body {
            color: rgba(255, 255, 255, 0.85);
        }
        .result-card-wrap .meter-bar {
            background: rgba(0, 0, 0, 0.4);
            border: 1px solid rgba(218, 165, 32, 0.2);
        }
        .result-card-wrap .meter-value {
            color: rgba(255, 215, 0, 0.9);
            font-weight: 600;
        }
        .result-card-wrap .note-box {
            background: rgba(218, 165, 32, 0.15);
            color: #FFD700;
            border: 1px solid rgba(218, 165, 32, 0.3);
            box-shadow: 0 0 20px rgba(218, 165, 32, 0.1);
        }
        .username-display {
            text-align: center;
            font-size: 22px;
            font-weight: 700;
            color: #FFD700;
            margin-bottom: 4px;
            text-shadow: 0 2px 10px rgba(255, 215, 0, 0.4);
        }
        .bdsm-row {
            display: flex;
            gap: 8px;
            flex-wrap: wrap;
            margin-top: 10px;
        }
        .bdsm-tag {
            padding: 8px 16px;
            border-radius: 20px;
            font-size: 13px;
            font-weight: 600;
            background: rgba(218, 165, 32, 0.2);
            color: #FFD700;
            border: 1px solid rgba(218, 165, 32, 0.4);
            backdrop-filter: blur(10px);
        }
        .bdsm-tag.high {
            background: rgba(255, 215, 0, 0.25);
            color: #FFD700;
            border: 1px solid #FFD700;
            font-weight: 700;
            box-shadow: 0 0 15px rgba(255, 215, 0, 0.3);
        }
        .input-section {
            margin-bottom: 30px;
        }
        .form-group {
            margin-bottom: 20px;
        }
        label {
            display: block;
            margin-bottom: 8px;
            color: rgba(255, 215, 0, 0.9);
            font-weight: 600;
            font-size: 14px;
        }
        input, select {
            width: 100%;
            padding: 14px;
            border: 1px solid rgba(218, 165, 32, 0.3);
            border-radius: 12px;
            font-size: 16px;
            background: rgba(40, 30, 20, 0.6);
            color: #e0e0e0;
            transition: all 0.3s;
            backdrop-filter: blur(10px);
        }
        input:focus, select:focus {
            outline: none;
            border-color: #FFD700;
            box-shadow: 0 0 20px rgba(255, 215, 0, 0.2);
            background: rgba(40, 30, 20, 0.8);
        }
        input::placeholder {
            color: rgba(255, 255, 255, 0.3);
        }
        .date-inputs {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 10px;
        }
        .time-inputs {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 10px;
        }
        button {
            width: 100%;
            padding: 18px;
            background: linear-gradient(135deg, #DAA520 0%, #FFD700 50%, #DAA520 100%);
            color: #000;
            border: none;
            border-radius: 15px;
            font-size: 18px;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.3s;
            box-shadow: 0 8px 25px rgba(218, 165, 32, 0.4);
            text-transform: uppercase;
            letter-spacing: 1px;
        }
        button:hover {
            transform: translateY(-3px);
            box-shadow: 0 12px 35px rgba(218, 165, 32, 0.6);
        }
        button:active {
            transform: translateY(-1px);
        }
        .result-section {
            display: none;
            margin-top: 30px;
        }
        .result-section.show {
            display: block;
        }
        .result-title {
            font-size: 22px;
            color: #333;
            margin-bottom: 20px;
            font-weight: 700;
            text-align: center;
        }
        .result-subtitle {
            text-align: center;
            color: #999;
            font-size: 12px;
            margin-top: -15px;
            margin-bottom: 20px;
        }
        .tag-row {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            margin-bottom: 24px;
            justify-content: center;
        }
        .tag {
            padding: 6px 16px;
            border-radius: 20px;
            font-size: 14px;
            font-weight: 600;
        }
        .tag-strong { background: rgba(218, 32, 32, 0.3); color: #ff6b6b; border: 1px solid rgba(218, 32, 32, 0.5); }
        .tag-medium { background: rgba(218, 165, 32, 0.3); color: #FFD700; border: 1px solid rgba(218, 165, 32, 0.5); }
        .tag-soft   { background: rgba(76, 175, 80, 0.3); color: #81c784; border: 1px solid rgba(76, 175, 80, 0.5); }
        .tag-active { background: rgba(33, 150, 243, 0.3); color: #64b5f6; border: 1px solid rgba(33, 150, 243, 0.5); }
        .tag-passive{ background: rgba(156, 39, 176, 0.3); color: #ba68c8; border: 1px solid rgba(156, 39, 176, 0.5); }
        .tag-balance{ background: rgba(0, 188, 212, 0.3); color: #4dd0e1; border: 1px solid rgba(0, 188, 212, 0.5); }
        .card {
            background: rgba(40, 30, 20, 0.4);
            border-radius: 14px;
            padding: 20px;
            margin-bottom: 14px;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.3);
            border: 1px solid rgba(218, 165, 32, 0.2);
        }
        .card-header {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 10px;
        }
        .card-icon {
            width: 36px;
            height: 36px;
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 18px;
            flex-shrink: 0;
            background: rgba(218, 165, 32, 0.2);
        }
        .card-title {
            font-weight: 700;
            font-size: 16px;
            color: #FFD700;
        }
        .card-body {
            color: rgba(255, 255, 255, 0.8);
            font-size: 15px;
            line-height: 1.8;
        }
        .meter-row {
            display: flex;
            align-items: center;
            gap: 12px;
            margin-bottom: 10px;
        }
        .meter-label {
            font-size: 13px;
            color: rgba(255, 215, 0, 0.7);
            width: 60px;
            flex-shrink: 0;
        }
        .meter-bar {
            flex: 1;
            height: 8px;
            background: rgba(0, 0, 0, 0.4);
            border-radius: 4px;
            overflow: hidden;
        }
        .meter-fill {
            height: 100%;
            border-radius: 4px;
            background: linear-gradient(90deg, #DAA520, #FFD700);
            box-shadow: 0 0 10px rgba(255, 215, 0, 0.5);
            transition: width 0.8s ease;
        }
        .meter-value {
            font-size: 13px;
            color: rgba(255, 215, 0, 0.9);
            width: 40px;
            text-align: right;
            flex-shrink: 0;
            font-weight: 600;
        }
        .divider {
            border: none;
            border-top: 1px solid rgba(218, 165, 32, 0.2);
            margin: 20px 0;
        }
        .note-box {
            background: rgba(218, 165, 32, 0.15);
            border-radius: 10px;
            padding: 14px 16px;
            font-size: 13px;
            color: #FFD700;
            margin-top: 14px;
            border: 1px solid rgba(218, 165, 32, 0.3);
        }

        /* ç§»åŠ¨ç«¯ä¼˜åŒ– */
        @media (max-width: 768px) {
            body {
                padding: 10px;
            }
            .container {
                padding: 25px 18px;
                border-radius: 20px;
            }
            h1 {
                font-size: 28px;
                letter-spacing: 1px;
            }
            .subtitle {
                font-size: 14px;
                margin-bottom: 25px;
            }
            .form-group {
                margin-bottom: 18px;
            }
            label {
                font-size: 15px;
                margin-bottom: 8px;
            }
            input, select {
                padding: 14px;
                font-size: 16px;
                border-radius: 10px;
            }
            button {
                padding: 16px;
                font-size: 17px;
                border-radius: 12px;
                letter-spacing: 0.5px;
            }
            .result-card-wrap {
                padding: 25px 18px;
                border-radius: 20px;
                margin-bottom: 15px;
            }
            .result-card-wrap .result-title {
                font-size: 22px;
                margin-bottom: 8px;
            }
            .result-card-wrap .result-subtitle {
                font-size: 14px;
                margin-bottom: 15px;
            }
            .result-card-wrap .card {
                padding: 16px;
                margin-bottom: 12px;
                border-radius: 12px;
            }
            .result-card-wrap .card-header {
                margin-bottom: 12px;
            }
            .result-card-wrap .card-icon {
                width: 32px;
                height: 32px;
                font-size: 16px;
            }
            .result-card-wrap .card-title {
                font-size: 16px;
            }
            .result-card-wrap .card-body {
                font-size: 15px;
                line-height: 1.8;
            }
            .result-card-wrap .username-display {
                font-size: 22px;
                margin-bottom: 8px;
            }
            .result-card-wrap .bdsm-row {
                gap: 6px;
                margin-top: 8px;
            }
            .result-card-wrap .bdsm-tag {
                padding: 8px 14px;
                font-size: 14px;
                border-radius: 16px;
            }
            .result-card-wrap .meter-row {
                gap: 10px;
                margin-bottom: 8px;
            }
            .result-card-wrap .meter-label {
                font-size: 13px;
                width: 55px;
            }
            .result-card-wrap .meter-bar {
                height: 8px;
            }
            .result-card-wrap .meter-value {
                font-size: 13px;
                width: 45px;
            }
            .result-card-wrap .note-box {
                font-size: 14px;
                padding: 12px 14px;
                margin-top: 12px;
            }
            .result-card-wrap .tag-row {
                gap: 8px;
                margin-bottom: 20px;
            }
            .result-card-wrap .tag {
                padding: 6px 14px;
                font-size: 14px;
            }
            .result-card-wrap .divider {
                margin: 16px 0;
            }
            .share-bar {
                gap: 8px;
                margin-top: 20px;
            }
            .share-bar button {
                padding: 14px;
                font-size: 15px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>æ€§åå¥½æµ‹è¯•</h1>
        <p class="subtitle">åŸºäºå‘½ç›˜çš„æ·±åº¦æ¨ç®—ï¼Œä»…ä¾›å¨±ä¹å‚è€ƒ</p>

        <div class="input-section">
            <div class="form-group">
                <label>ä½ çš„åå­—ï¼ˆæ˜¾ç¤ºåœ¨ç»“æœä¸­ï¼‰</label>
                <input type="text" id="username" placeholder="è¾“å…¥æ˜µç§°æˆ–çœŸå" maxlength="20">
            </div>

            <div class="form-group">
                <label>å†æ³•é€‰æ‹©</label>
                <select id="calendarType">
                    <option value="solar">å…¬å†ï¼ˆé˜³å†ï¼‰</option>
                    <option value="lunar">å†œå†ï¼ˆé˜´å†ï¼‰</option>
                </select>
            </div>

            <div class="form-group">
                <label>å‡ºç”Ÿæ—¥æœŸ</label>
                <div class="date-inputs">
                    <input type="number" id="year" placeholder="å¹´" min="1900" max="2100">
                    <input type="number" id="month" placeholder="æœˆ" min="1" max="12">
                    <input type="number" id="day" placeholder="æ—¥" min="1" max="31">
                </div>
            </div>

            <div class="form-group">
                <label>å‡ºç”Ÿæ—¶è¾°</label>
                <select id="hour">
                    <option value="0">å­æ—¶ï¼ˆ23:00â€“01:00ï¼‰</option>
                    <option value="2">ä¸‘æ—¶ï¼ˆ01:00â€“03:00ï¼‰</option>
                    <option value="4">å¯…æ—¶ï¼ˆ03:00â€“05:00ï¼‰</option>
                    <option value="6">å¯æ—¶ï¼ˆ05:00â€“07:00ï¼‰</option>
                    <option value="8">è¾°æ—¶ï¼ˆ07:00â€“09:00ï¼‰</option>
                    <option value="10">å·³æ—¶ï¼ˆ09:00â€“11:00ï¼‰</option>
                    <option value="12">åˆæ—¶ï¼ˆ11:00â€“13:00ï¼‰</option>
                    <option value="14">æœªæ—¶ï¼ˆ13:00â€“15:00ï¼‰</option>
                    <option value="16">ç”³æ—¶ï¼ˆ15:00â€“17:00ï¼‰</option>
                    <option value="18">é…‰æ—¶ï¼ˆ17:00â€“19:00ï¼‰</option>
                    <option value="20">æˆŒæ—¶ï¼ˆ19:00â€“21:00ï¼‰</option>
                    <option value="22">äº¥æ—¶ï¼ˆ21:00â€“23:00ï¼‰</option>
                    <option value="-1">ä¸çŸ¥é“</option>
                </select>
            </div>

            <div class="form-group">
                <label>æ€§åˆ«</label>
                <select id="gender">
                    <option value="male">ç”·</option>
                    <option value="female">å¥³</option>
                </select>
            </div>

            <button onclick="analyze()">å¼€å§‹åˆ†æ</button>
        </div>

        <div class="result-section" id="resultSection">
            <div id="resultContent"></div>
        </div>
    </div>

    <script>
        // ç´«å¾®æ–—æ•°æ ¸å¿ƒç®—æ³•
        const ZiWei = {
            // å¤©å¹²
            tianGan: ['ç”²', 'ä¹™', 'ä¸™', 'ä¸', 'æˆŠ', 'å·±', 'åºš', 'è¾›', 'å£¬', 'ç™¸'],
            // åœ°æ”¯
            diZhi: ['å­', 'ä¸‘', 'å¯…', 'å¯', 'è¾°', 'å·³', 'åˆ', 'æœª', 'ç”³', 'é…‰', 'æˆŒ', 'äº¥'],
            // åäºŒå®«ä½
            gongWei: ['å‘½å®«', 'å…„å¼Ÿå®«', 'å¤«å¦»å®«', 'å­å¥³å®«', 'è´¢å¸›å®«', 'ç–¾å„å®«', 'è¿ç§»å®«', 'å¥´ä»†å®«', 'å®˜ç¦„å®«', 'ç”°å®…å®«', 'ç¦å¾·å®«', 'çˆ¶æ¯å®«'],

            // ä¸»æ˜Ÿ
            mainStars: {
                'ç´«å¾®': { type: 'å¸åº§', nature: 'åœŸ' },
                'å¤©æœº': { type: 'æ™ºæ…§', nature: 'æœ¨' },
                'å¤ªé˜³': { type: 'å…‰æ˜', nature: 'ç«' },
                'æ­¦æ›²': { type: 'è´¢æ˜Ÿ', nature: 'é‡‘' },
                'å¤©åŒ': { type: 'ç¦æ˜Ÿ', nature: 'æ°´' },
                'å»‰è´': { type: 'å›šæ˜Ÿ', nature: 'ç«' },
                'å¤©åºœ': { type: 'è´¢åº“', nature: 'åœŸ' },
                'å¤ªé˜´': { type: 'è´¢æ˜Ÿ', nature: 'æ°´' },
                'è´ªç‹¼': { type: 'æ¡ƒèŠ±', nature: 'æ°´æœ¨' },
                'å·¨é—¨': { type: 'æš—æ˜Ÿ', nature: 'æ°´' },
                'å¤©ç›¸': { type: 'å°æ˜Ÿ', nature: 'æ°´' },
                'å¤©æ¢': { type: 'è«æ˜Ÿ', nature: 'åœŸ' },
                'ä¸ƒæ€': { type: 'å°†æ˜Ÿ', nature: 'é‡‘' },
                'ç ´å†›': { type: 'è€—æ˜Ÿ', nature: 'æ°´' }
            },

            // å››åŒ–
            siHua: {
                'ç”²': { lu: 'å»‰è´', quan: 'ç ´å†›', ke: 'æ­¦æ›²', ji: 'å¤ªé˜³' },
                'ä¹™': { lu: 'å¤©æœº', quan: 'å¤©æ¢', ke: 'ç´«å¾®', ji: 'å¤ªé˜´' },
                'ä¸™': { lu: 'å¤©åŒ', quan: 'å¤©æœº', ke: 'æ–‡æ˜Œ', ji: 'å»‰è´' },
                'ä¸': { lu: 'å¤ªé˜´', quan: 'å¤©åŒ', ke: 'å¤©æœº', ji: 'å·¨é—¨' },
                'æˆŠ': { lu: 'è´ªç‹¼', quan: 'å¤ªé˜´', ke: 'å³å¼¼', ji: 'å¤©æœº' },
                'å·±': { lu: 'æ­¦æ›²', quan: 'è´ªç‹¼', ke: 'å¤©æ¢', ji: 'æ–‡æ›²' },
                'åºš': { lu: 'å¤ªé˜³', quan: 'æ­¦æ›²', ke: 'å¤ªé˜´', ji: 'å¤©åŒ' },
                'è¾›': { lu: 'å·¨é—¨', quan: 'å¤ªé˜³', ke: 'æ–‡æ›²', ji: 'æ–‡æ˜Œ' },
                'å£¬': { lu: 'å¤©æ¢', quan: 'ç´«å¾®', ke: 'å·¦è¾…', ji: 'æ­¦æ›²' },
                'ç™¸': { lu: 'ç ´å†›', quan: 'å·¨é—¨', ke: 'å¤ªé˜´', ji: 'è´ªç‹¼' }
            },

            // å†œå†æ•°æ®è¡¨ 1900-2100 (æ¯æ¡24bit: é«˜4bit=é—°æœˆå¤§å°, ä¸­4bit=é—°æœˆæœˆä»½, ä½16bit=å„æœˆå¤§å°)
            lunarInfo: [
                0x04AE53,0x0A5748,0x5526BD,0x0D2650,0x0D9544,0x46AAB9,0x056A4D,0x09AD42,0x24AEB6,0x04AE4A,
                0x6AA550,0x0B5544,0x0AD550,0x515B45,0x056A4D,0x0A6B42,0x25AAB6,0x04AE4A,0x6B2550,0x0B2544,
                0x0B5540,0x4B6A45,0x0AD550,0x0955B2,0x2497B7,0x04974B,0x66A550,0x0EA544,0x0EA550,0x5B5A45,
                0x056A4D,0x0A6B42,0x25AAB6,0x04AE4A,0x6B2550,0x0B2544,0x0B5540,0x4B6A45,0x0AD550,0x0955B2,
                0x2497B7,0x04974B,0x66A550,0x0EA544,0x0EA550,0x5B5A45,0x056A4D,0x0A6B42,0x25AAB6,0x04AE4A,
                0x6AA550,0x0B5544,0x0AD550,0x515B45,0x056A4D,0x0A6B42,0x25AAB6,0x04AE4A,0x6B2550,0x0B2544,
                0x0B5540,0x4B6A45,0x0AD550,0x0955B2,0x2497B7,0x04974B,0x66A550,0x0EA544,0x0EA550,0x5B5A45,
                0x056A4D,0x0A6B42,0x25AAB6,0x04AE4A,0x6AA550,0x0B5544,0x0AD550,0x515B45,0x056A4D,0x0A6B42,
                0x25AAB6,0x04AE4A,0x6B2550,0x0B2544,0x0B5540,0x4B6A45,0x0AD550,0x0955B2,0x2497B7,0x04974B,
                0x66A550,0x0EA544,0x0EA550,0x5B5A45,0x056A4D,0x0A6B42,0x25AAB6,0x04AE4A,0x6AA550,0x0B5544,
                0x0AD550,0x515B45,0x056A4D,0x0A6B42,0x25AAB6,0x04AE4A,0x6B2550,0x0B2544,0x0B5540,0x4B6A45,
                0x0AD550,0x0955B2,0x2497B7,0x04974B,0x66A550,0x0EA544,0x0EA550,0x5B5A45,0x056A4D,0x0A6B42,
                0x25AAB6,0x04AE4A,0x6AA550,0x0B5544,0x0AD550,0x515B45,0x056A4D,0x0A6B42,0x25AAB6,0x04AE4A,
                0x6B2550,0x0B2544,0x0B5540,0x4B6A45,0x0AD550,0x0955B2,0x2497B7,0x04974B,0x66A550,0x0EA544,
                0x0EA550,0x5B5A45,0x056A4D,0x0A6B42,0x25AAB6,0x04AE4A,0x6AA550,0x0B5544,0x0AD550,0x515B45,
                0x056A4D,0x0A6B42,0x25AAB6,0x04AE4A,0x6B2550,0x0B2544,0x0B5540,0x4B6A45,0x0AD550,0x0955B2,
                0x2497B7,0x04974B,0x66A550,0x0EA544,0x0EA550,0x5B5A45,0x056A4D,0x0A6B42,0x25AAB6,0x04AE4A,
                0x6AA550,0x0B5544,0x0AD550,0x515B45,0x056A4D,0x0A6B42,0x25AAB6,0x04AE4A,0x6B2550,0x0B2544,
                0x0B5540,0x4B6A45,0x0AD550,0x0955B2,0x2497B7,0x04974B,0x66A550,0x0EA544,0x0EA550,0x5B5A45,
                0x056A4D,0x0A6B42,0x25AAB6,0x04AE4A,0x6AA550,0x0B5544,0x0AD550,0x515B45,0x056A4D,0x0A6B42
            ],

            // å…¬å†è½¬å†œå†
            solarToLunar: function(year, month, day) {
                // åŸºå‡†æ—¥æœŸï¼š1900å¹´1æœˆ31æ—¥ = å†œå†1900å¹´æ­£æœˆåˆä¸€
                const baseDate = new Date(1900, 0, 31);
                const objDate = new Date(year, month - 1, day);
                let offset = Math.round((objDate - baseDate) / 86400000);

                let lunarYear = 1900;
                let daysInYear;

                // æ‰¾åˆ°å†œå†å¹´
                while (lunarYear < 2100) {
                    daysInYear = this.lunarYearDays(lunarYear);
                    if (offset < daysInYear) break;
                    offset -= daysInYear;
                    lunarYear++;
                }

                const leapMonth = this.leapMonth(lunarYear);
                let isLeap = false;
                let lunarMonth = 1;

                while (lunarMonth <= 12) {
                    let daysInMonth;
                    if (isLeap) {
                        daysInMonth = this.leapDays(lunarYear);
                        isLeap = false;
                        if (offset < daysInMonth) break;
                        offset -= daysInMonth;
                        lunarMonth++;
                        continue;
                    }
                    daysInMonth = this.monthDays(lunarYear, lunarMonth);
                    if (offset < daysInMonth) break;
                    offset -= daysInMonth;
                    if (lunarMonth === leapMonth) {
                        isLeap = true;
                    } else {
                        lunarMonth++;
                    }
                }

                return { year: lunarYear, month: lunarMonth, day: offset + 1, isLeap };
            },

            // å†œå†å¹´æ€»å¤©æ•°
            lunarYearDays: function(y) {
                let sum = 348;
                for (let i = 0x8000; i > 0x8; i >>= 1) {
                    sum += (this.lunarInfo[y - 1900] & i) ? 1 : 0;
                }
                return sum + this.leapDays(y);
            },

            // é—°æœˆå¤©æ•°
            leapDays: function(y) {
                if (this.leapMonth(y)) {
                    return (this.lunarInfo[y - 1900] & 0x10000) ? 30 : 29;
                }
                return 0;
            },

            // é—°æœˆæœˆä»½
            leapMonth: function(y) {
                return this.lunarInfo[y - 1900] & 0xf;
            },

            // æŸæœˆå¤©æ•°
            monthDays: function(y, m) {
                return (this.lunarInfo[y - 1900] & (0x10000 >> m)) ? 30 : 29;
            },

            // è·å–ç”Ÿå¹´å¤©å¹²
            getYearGan: function(year) {
                return this.tianGan[(year - 4) % 10];
            },

            // è·å–ç”Ÿå¹´åœ°æ”¯
            getYearZhi: function(year) {
                return this.diZhi[(year - 4) % 12];
            },

            // æ—¶è¾°è½¬åœ°æ”¯åºå· (0=å­, 1=ä¸‘, ..., 11=äº¥)
            hourToZhi: function(hour) {
                // 23-1ç‚¹=å­, 1-3=ä¸‘, 3-5=å¯…, ...
                return Math.floor((hour + 1) / 2) % 12;
            },

            // è®¡ç®—å‘½å®«åœ°æ”¯åºå·
            // è§„åˆ™ï¼šå¯…å®«(index=2)èµ·æ­£æœˆï¼Œé¡ºæ•°è‡³ç”Ÿæœˆï¼Œå†ä»è¯¥å®«é€†æ•°è‡³ç”Ÿæ—¶åœ°æ”¯
            getMingGongZhi: function(lunarMonth, hour) {
                const monthZhi = (lunarMonth + 1) % 12; // æ­£æœˆåœ¨å¯…(2)ï¼Œè¿™é‡Œç”¨0-based index
                const shiZhi = this.hourToZhi(hour);
                // å‘½å®« = å¯… + (æœˆ-1) - æ—¶æ”¯ï¼Œé€†æ•°
                let mingZhi = (2 + lunarMonth - 1 - shiZhi + 12) % 12;
                return mingZhi;
            },

            // æ ¹æ®ç”Ÿæ—¥è®¡ç®—ç´«å¾®æ˜Ÿæ‰€åœ¨åœ°æ”¯
            // æ ‡å‡†ç®—æ³•ï¼šä»¥ç”Ÿæ—¥æ•°æŸ¥äº”è¡Œå±€ï¼Œå†å®šç´«å¾®ä½ç½®
            getZiWeiZhi: function(lunarDay, ju) {
                // ju: äº”è¡Œå±€æ•° (2=æ°´äºŒå±€, 3=æœ¨ä¸‰å±€, 4=é‡‘å››å±€, 5=åœŸäº”å±€, 6=ç«å…­å±€)
                // ç´«å¾®å®‰æ˜Ÿè¡¨ï¼ˆæŒ‰äº”è¡Œå±€å’Œç”Ÿæ—¥ï¼‰
                const ziWeiTable = {
                    2: [0,1,2,3,4,5,6,7,8,9,10,11,0,1,2,3,4,5,6,7,8,9,10,11,0,1,2,3,4,11],
                    3: [0,0,1,2,3,4,5,6,7,8,9,10,11,0,1,2,3,4,5,6,7,8,9,10,11,0,1,2,3,4],
                    4: [0,0,0,1,2,3,4,5,6,7,8,9,10,11,0,1,2,3,4,5,6,7,8,9,10,11,0,1,2,3],
                    5: [0,0,0,0,1,2,3,4,5,6,7,8,9,10,11,0,1,2,3,4,5,6,7,8,9,10,11,0,1,2],
                    6: [0,0,0,0,0,1,2,3,4,5,6,7,8,9,10,11,0,1,2,3,4,5,6,7,8,9,10,11,0,1]
                };
                return ziWeiTable[ju][lunarDay - 1];
            },

            // æ ¹æ®å‘½å®«åœ°æ”¯å’Œç”Ÿå¹´å¹²æ”¯ç¡®å®šäº”è¡Œå±€
            getJu: function(mingZhi, yearGan) {
                // çº³éŸ³äº”è¡Œå±€ï¼šæ ¹æ®å‘½å®«åœ°æ”¯å’Œå¹´å¹²ç¡®å®š
                // ç®€åŒ–ï¼šç”¨å‘½å®«åœ°æ”¯åºå· mod 5 + 2 æ¥è¿‘ä¼¼
                const juMap = [2,3,4,5,6,2,3,4,5,6,2,3];
                return juMap[mingZhi];
            },

            // æ’ç›˜
            paipan: function(lunarYear, lunarMonth, lunarDay, hour, gender) {
                const mingZhi = this.getMingGongZhi(lunarMonth, hour);
                const yearGan = this.getYearGan(lunarYear);
                const ju = this.getJu(mingZhi, yearGan);
                const ziWeiZhi = this.getZiWeiZhi(lunarDay, ju);

                // åˆå§‹åŒ–åäºŒå®«ï¼Œå‘½å®«åœ¨ mingZhi åœ°æ”¯
                const chart = {};
                for (let i = 0; i < 12; i++) {
                    const zhiIndex = (mingZhi + i) % 12;
                    chart[this.gongWei[i]] = {
                        diZhi: this.diZhi[zhiIndex],
                        zhiIndex: zhiIndex,
                        stars: [],
                        sihua: []
                    };
                }

                // å®‰ä¸»æ˜Ÿ
                this.placeMainStars(chart, ziWeiZhi, mingZhi);

                // å®‰å››åŒ–
                this.placeSiHua(chart, yearGan);

                return chart;
            },

            // å®‰ä¸»æ˜Ÿï¼ˆæ ‡å‡†ç´«å¾®æ–—æ•°ç®—æ³•ï¼‰
            placeMainStars: function(chart, ziWeiZhi, mingZhi) {
                // ç´«å¾®æ˜Ÿç³»ï¼šç´«å¾®åœ¨ ziWeiZhiï¼Œå…¶ä½™æŒ‰å›ºå®šé—´è·
                // å¤©æœºåœ¨ç´«å¾®å‰ä¸€å®«ï¼Œå¤ªé˜³å‰ä¸‰å®«ï¼Œæ­¦æ›²å‰å››å®«ï¼Œå¤©åŒå‰äº”å®«ï¼Œå»‰è´å‰å…«å®«
                const ziWeiGroup = [
                    { name: 'ç´«å¾®', offset: 0 },
                    { name: 'å¤©æœº', offset: -1 },
                    { name: 'å¤ªé˜³', offset: -3 },
                    { name: 'æ­¦æ›²', offset: -4 },
                    { name: 'å¤©åŒ', offset: -5 },
                    { name: 'å»‰è´', offset: -8 }
                ];

                // å¤©åºœæ˜Ÿç³»ï¼šå¤©åºœä¸ç´«å¾®å¯¹å®«ï¼ˆç›¸å·®6å®«ï¼‰
                const tianFuZhi = (ziWeiZhi + 6) % 12;
                const tianFuGroup = [
                    { name: 'å¤©åºœ', offset: 0 },
                    { name: 'å¤ªé˜´', offset: 1 },
                    { name: 'è´ªç‹¼', offset: 2 },
                    { name: 'å·¨é—¨', offset: 3 },
                    { name: 'å¤©ç›¸', offset: 4 },
                    { name: 'å¤©æ¢', offset: 5 },
                    { name: 'ä¸ƒæ€', offset: 6 },
                    { name: 'ç ´å†›', offset: 8 }
                ];

                const gongNames = Object.keys(chart);

                // æ”¾ç½®ç´«å¾®æ˜Ÿç³»
                ziWeiGroup.forEach(({ name, offset }) => {
                    const zhi = (ziWeiZhi + offset + 12) % 12;
                    // æ‰¾åˆ°è¯¥åœ°æ”¯å¯¹åº”çš„å®«ä½
                    const gongIdx = gongNames.findIndex(g => chart[g].zhiIndex === zhi);
                    if (gongIdx >= 0) chart[gongNames[gongIdx]].stars.push(name);
                });

                // æ”¾ç½®å¤©åºœæ˜Ÿç³»
                tianFuGroup.forEach(({ name, offset }) => {
                    const zhi = (tianFuZhi + offset) % 12;
                    const gongIdx = gongNames.findIndex(g => chart[g].zhiIndex === zhi);
                    if (gongIdx >= 0) chart[gongNames[gongIdx]].stars.push(name);
                });
            },

            // å®‰å››åŒ–
            placeSiHua: function(chart, yearGan) {
                const sihua = this.siHua[yearGan];
                if (!sihua) return;

                for (let gongName in chart) {
                    const gong = chart[gongName];
                    gong.stars.forEach(star => {
                        if (star === sihua.lu) gong.sihua.push('åŒ–ç¦„');
                        if (star === sihua.quan) gong.sihua.push('åŒ–æƒ');
                        if (star === sihua.ke) gong.sihua.push('åŒ–ç§‘');
                        if (star === sihua.ji) gong.sihua.push('åŒ–å¿Œ');
                    });
                }
            }
        };

        // æ€§åå¥½åˆ†æé€»è¾‘
        function analyzePreference(chart, gender, username) {
            const ziNv = chart['å­å¥³å®«'];
            const jiE  = chart['ç–¾å„å®«'];
            const ming = chart['å‘½å®«'];
            const fuDe = chart['ç¦å¾·å®«'];
            const fuQi = chart['å¤«å¦»å®«'];

            const allStars  = [...ziNv.stars, ...jiE.stars, ...ming.stars, ...fuDe.stars];
            const allSihua  = [...ziNv.sihua, ...jiE.sihua, ...ming.sihua, ...fuDe.sihua];
            const fuQiStars = fuQi.stars;

            const hasStar = (gong, ...names) => names.some(n => gong.stars.includes(n));
            const hasSihua = (gong, ...types) => types.some(t => gong.sihua.includes(t));

            // â”€â”€ æ¬²æœ›å¼ºåº¦ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
            const taoHua   = allStars.filter(s => ['è´ªç‹¼','å»‰è´'].includes(s)).length;
            const softStar = allStars.filter(s => ['å¤©åŒ','å¤ªé˜´','å¤©æ¢','å¤©ç›¸'].includes(s)).length;
            const hasLu    = allSihua.includes('åŒ–ç¦„');
            const hasQuan  = allSihua.includes('åŒ–æƒ');
            const hasJi    = allSihua.filter(s => s === 'åŒ–å¿Œ').length;

            let desireLevel, desireBar, desireText;
            if (taoHua >= 2 || (taoHua >= 1 && hasLu)) {
                desireLevel = 'æ—ºç››'; desireBar = 85;
                desireText = 'ä½ çš„æ€§æ¬²æœ›å±äºå¤©ç”Ÿæ—ºç››å‹ï¼Œå¯¹äº²å¯†å…³ç³»æœ‰å¼ºçƒˆä¸”æŒç»­çš„ä¸»åŠ¨éœ€æ±‚ã€‚ä¸éœ€è¦å¤ªå¤šå¤–éƒ¨åˆºæ¿€å°±èƒ½è¿›å…¥çŠ¶æ€ï¼Œèº«ä½“å¯¹æ„Ÿå®˜ä¿¡å·çš„ååº”éå¸¸çµæ•ã€‚ä½ å¾ˆéš¾é•¿æ—¶é—´å‹æŠ‘è¿™æ–¹é¢çš„éœ€æ±‚ï¼Œç¦æ¬²å¯¹ä½ æ¥è¯´æ˜¯ä¸€ç§çœŸå®çš„æ¶ˆè€—ã€‚äº«å—äº²å¯†å…³ç³»æœ¬èº«å¸¦æ¥çš„æ„‰æ‚¦æ„Ÿï¼Œä¸åªæ˜¯ä¸ºäº†æƒ…æ„Ÿè¿æ¥ï¼Œæ„Ÿå®˜ä½“éªŒæœ¬èº«å°±æ˜¯ç›®çš„ä¹‹ä¸€ã€‚ä¼´ä¾£çš„é¢‘ç‡å¦‚æœè·Ÿä¸ä¸Šä½ ï¼Œå®¹æ˜“äº§ç”Ÿè½å·®æ„Ÿã€‚';
            } else if (taoHua === 1) {
                desireLevel = 'è¾ƒå¼º'; desireBar = 65;
                desireText = 'æ¬²æœ›åå¼ºï¼Œåœ¨åˆé€‚çš„æ°›å›´å’Œå¯¹è±¡é¢å‰å¾ˆå®¹æ˜“è¢«ç‚¹ç‡ƒã€‚å¹³æ—¶å¯ä»¥è‡ªæˆ‘å…‹åˆ¶ï¼Œä½†ä¸€æ—¦è¿›å…¥çŠ¶æ€å°±å¾ˆæŠ•å…¥ï¼Œä¸å–œæ¬¢è‰è‰äº†äº‹ã€‚å¯¹äº²å¯†å…³ç³»æœ‰æ˜æ˜¾çš„å…´è¶£å’ŒæœŸå¾…ï¼Œä¼šä¸»åŠ¨åˆ›é€ æœºä¼šã€‚æƒ…ç»ªå¥½çš„æ—¶å€™æ¬²æœ›ä¼šæ˜æ˜¾ä¸Šå‡ï¼Œæƒ…ç»ªä½è½æ—¶åˆ™ä¼šæœ‰æ‰€æ”¶æ•›â€”â€”ä½ çš„çŠ¶æ€å’Œå¿ƒæƒ…å¯¹æ¬²æœ›çš„å½±å“æ¯”è¾ƒç›´æ¥ã€‚';
            } else if (softStar >= 2) {
                desireLevel = 'åæ·¡'; desireBar = 30;
                desireText = 'ä½ å¯¹æ€§çš„éœ€æ±‚ç›¸å¯¹æ·¡è–„ï¼Œæ›´çœ‹é‡æƒ…æ„Ÿè¿æ¥å’Œç²¾ç¥å¥‘åˆï¼Œçº¯ç²¹çš„æ„Ÿå®˜åˆºæ¿€å¯¹ä½ çš„å¸å¼•åŠ›æœ‰é™ã€‚ä¸æ˜¯æ²¡æœ‰æ¬²æœ›ï¼Œè€Œæ˜¯é—¨æ§›æ¯”è¾ƒé«˜â€”â€”éœ€è¦è¶³å¤Ÿçš„ä¿¡ä»»ã€è¶³å¤Ÿçš„æƒ…æ„ŸåŸºç¡€ï¼Œæ‰èƒ½çœŸæ­£æŠ•å…¥ã€‚é•¿æ—¶é—´æ²¡æœ‰äº²å¯†å…³ç³»ä¹Ÿä¸ä¼šç‰¹åˆ«éš¾å—ï¼Œç²¾ç¥ä¸Šçš„æ»¡è¶³æ„Ÿå¯¹ä½ æ¥è¯´æ›´é‡è¦ã€‚ä¼´ä¾£å¦‚æœåªæ³¨é‡è‚‰ä½“å±‚é¢è€Œå¿½è§†æƒ…æ„Ÿï¼Œä½ ä¼šæ„Ÿåˆ°ç©ºæ´ç”šè‡³æ’æ–¥ã€‚';
            } else {
                desireLevel = 'é€‚ä¸­'; desireBar = 50;
                desireText = 'æ¬²æœ›å¤„äºæ­£å¸¸æ°´å¹³ï¼Œæœ‰éœ€æ±‚ä½†ä¸å¼ºçƒˆï¼Œä¸ä¼šä¸»åŠ¨å»è¿½æ±‚ä¹Ÿä¸ä¼šåˆ»æ„å›é¿ã€‚æƒ…ç»ªã€æ°›å›´ã€å¯¹è±¡çš„çŠ¶æ€å¯¹ä½ çš„æ¬²æœ›å½±å“å¾ˆå¤§â€”â€”å¥½çš„æ°›å›´èƒ½è®©ä½ å®Œå…¨æŠ•å…¥ï¼Œä¸å¯¹çš„æ„Ÿè§‰åˆ™ä¼šè®©ä½ æä¸èµ·å…´è¶£ã€‚ä½ ä¸æ˜¯é‚£ç§éšæ—¶éšåœ°éƒ½èƒ½è¿›å…¥çŠ¶æ€çš„äººï¼Œéœ€è¦ä¸€å®šçš„"é¢„çƒ­"è¿‡ç¨‹ã€‚æ•´ä½“æ¥è¯´æ¯”è¾ƒå¹³è¡¡ï¼Œä¸ä¼šå› ä¸ºæ¬²æœ›é—®é¢˜äº§ç”Ÿå¤ªå¤§çš„å›°æ‰°ã€‚';
            }

            // â”€â”€ ä¸»è¢«åŠ¨å€¾å‘ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
            const strongStar = allStars.filter(s => ['ä¸ƒæ€','ç ´å†›','æ­¦æ›²','å¤ªé˜³','å»‰è´'].includes(s)).length;
            let roleText, roleTag, roleTagClass;
            if (strongStar >= 2 || hasQuan) {
                roleTag = 'ä¸»å¯¼å‹'; roleTagClass = 'tag-active';
                roleText = 'ä½ å¤©ç”Ÿåå‘ä¸»å¯¼ï¼Œå–œæ¬¢æŒæ§èŠ‚å¥ã€å†³å®šæ–¹å‘ï¼Œè¢«åŠ¨ç­‰å¾…ä¼šè®©ä½ æ„Ÿåˆ°ç„¦è™‘ç”šè‡³å¤±å»å…´è¶£ã€‚åœ¨äº²å¯†å…³ç³»ä¸­ï¼Œä½ æ›´äº«å—å¼•é¢†å¯¹æ–¹çš„æ„Ÿè§‰â€”â€”å†³å®šæ—¶é—´ã€åœ°ç‚¹ã€æ–¹å¼ï¼Œè¿™ç§æŒæ§æ„Ÿæœ¬èº«å°±æ˜¯å…´å¥‹ç‚¹çš„ä¸€éƒ¨åˆ†ã€‚ä½ ä¸å–œæ¬¢å¯¹æ–¹å®Œå…¨ä¸é…åˆæˆ–è¿‡äºè¢«åŠ¨ï¼Œä½†ä¹Ÿä¸éœ€è¦å¯¹æ–¹å®Œå…¨é¡ºä»ï¼Œé€‚åº¦çš„å¼ åŠ›å’Œå›åº”æ‰æ˜¯ä½ æœ€äº«å—çš„çŠ¶æ€ã€‚å¦‚æœå¯¹æ–¹æ¯”ä½ æ›´å¼ºåŠ¿ï¼Œä½ å¯èƒ½ä¼šæ„Ÿåˆ°ä¸é€‚ç”šè‡³äº§ç”ŸæŠµè§¦ã€‚åœ¨ä¿¡ä»»çš„å…³ç³»é‡Œï¼Œä½ æ„¿æ„å¶å°”æ”¾ä¸‹ä¸»å¯¼æƒï¼Œä½†é‚£éœ€è¦å¯¹æ–¹çœŸæ­£èµ¢å¾—ä½ çš„ä¿¡ä»»ã€‚';
            } else if (softStar >= 2 && !hasQuan) {
                roleTag = 'é…åˆå‹'; roleTagClass = 'tag-passive';
                roleText = 'ä½ åå‘é…åˆå’Œå›åº”ï¼Œäº«å—è¢«å¼•å¯¼ã€è¢«ç…§é¡¾çš„æ„Ÿè§‰ã€‚å¯¹æ–¹çš„ä¸»åŠ¨ä¼šè®©ä½ æ›´æ”¾æ¾ã€æ›´æŠ•å…¥ï¼Œä¸éœ€è¦è‡ªå·±å»æƒ³"ä¸‹ä¸€æ­¥åšä»€ä¹ˆ"åè€Œè®©ä½ æ„Ÿåˆ°è‡ªåœ¨ã€‚ä½ ä¸å–œæ¬¢å‹åŠ›æ„Ÿï¼Œéœ€è¦è¶³å¤Ÿçš„å®‰å…¨æ„Ÿå’Œä¿¡ä»»åŸºç¡€æ‰èƒ½å®Œå…¨æ”¾å¼€ã€‚è¢«åŠ¨ä¸ä»£è¡¨æ²¡æœ‰éœ€æ±‚ï¼Œåªæ˜¯ä½ æ›´ä¹ æƒ¯ç”¨å›åº”æ¥è¡¨è¾¾ï¼Œè€Œä¸æ˜¯ä¸»åŠ¨å‘èµ·ã€‚å¦‚æœå¯¹æ–¹ä¹Ÿæ˜¯è¢«åŠ¨å‹ï¼Œå…³ç³»å®¹æ˜“é™·å…¥åƒµå±€â€”â€”ä½ éœ€è¦ä¸€ä¸ªæ„¿æ„ä¸»åŠ¨çš„ä¼´ä¾£æ¥æ¿€æ´»ä½ ã€‚';
            } else {
                roleTag = 'çµæ´»å‹'; roleTagClass = 'tag-balance';
                roleText = 'ä½ çš„ä¸»è¢«åŠ¨å€¾å‘æ¯”è¾ƒçµæ´»ï¼Œèƒ½æ ¹æ®å¯¹æ–¹å’Œå½“ä¸‹çš„æ°›å›´è‡ªç„¶åˆ‡æ¢ï¼Œè¿™æ˜¯ä¸€ç§éš¾å¾—çš„é€‚åº”èƒ½åŠ›ã€‚æ—¢èƒ½åœ¨å¯¹æ–¹éœ€è¦æ—¶ä¸»åŠ¨å‡ºå‡»ï¼Œä¹Ÿèƒ½åœ¨å¯¹æ–¹å¼ºåŠ¿æ—¶äº«å—è¢«å¼•å¯¼çš„æ„Ÿè§‰ã€‚ä½ ä¸ä¼šå›ºæ‰§åœ°åšæŒæŸä¸€ç§è§’è‰²ï¼Œæ›´åœ¨æ„çš„æ˜¯æ•´ä½“çš„æµåŠ¨æ„Ÿå’ŒåŒæ–¹çš„å¥‘åˆåº¦ã€‚è¿™ç§çµæ´»æ€§è®©ä½ èƒ½å’Œä¸åŒç±»å‹çš„äººéƒ½å»ºç«‹è‰¯å¥½çš„äº²å¯†å…³ç³»ï¼Œä½†æœ‰æ—¶å€™ä¹Ÿå¯èƒ½è®©å¯¹æ–¹æ‘¸ä¸æ¸…ä½ çœŸæ­£æƒ³è¦ä»€ä¹ˆâ€”â€”é€‚å½“è¡¨è¾¾è‡ªå·±çš„åå¥½ä¼šè®©å…³ç³»æ›´é¡ºç•…ã€‚';
            }

            // â”€â”€ é£æ ¼åå¥½ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
            const styleItems = [];
            if (hasStar(ziNv, 'è´ªç‹¼') || hasStar(fuDe, 'è´ªç‹¼')) styleItems.push({ icon: 'ğŸ”¥', text: 'å–œæ¬¢æ–°é²œæ„Ÿï¼Œå®¹æ˜“å¯¹é‡å¤çš„æ¨¡å¼æ„Ÿåˆ°åŒå€¦ã€‚ä½ çš„æ¢ç´¢æ¬²å¾ˆå¼ºï¼ŒåŒä¸€ç§æ–¹å¼åšä¸‰æ¬¡ä»¥ä¸Šå°±å¼€å§‹è§‰å¾—æ— èŠã€‚å–œæ¬¢å°è¯•æ–°çš„åœºæ™¯ã€æ–°çš„æ–¹å¼ã€ç”šè‡³æ–°çš„å¯¹è±¡â€”â€”ä¸æ˜¯å› ä¸ºä¸å¿ ï¼Œè€Œæ˜¯æ–°é²œæ„Ÿæœ¬èº«å°±æ˜¯ä½ æœ€å¤§çš„å…´å¥‹å‰‚ã€‚ä¼´ä¾£å¦‚æœèƒ½æŒç»­ç»™ä½ å¸¦æ¥æƒŠå–œï¼Œä½ ä¼šéå¸¸æŠ•å…¥ï¼›å¦‚æœå…³ç³»å˜å¾—å¤ªè¿‡ä¾‹è¡Œå…¬äº‹ï¼Œä½ çš„çƒ­æƒ…ä¼šå¿«é€Ÿæ¶ˆé€€ã€‚' });
            if (hasStar(ziNv, 'å»‰è´') || hasStar(ming, 'å»‰è´')) styleItems.push({ icon: 'âš¡', text: 'è¿½æ±‚æ¿€æƒ…å’Œå¼ºçƒˆçš„æ„Ÿå®˜ä½“éªŒï¼Œå¹³æ·¡å¯¹ä½ æ¥è¯´æ˜¯æœ€å¤§çš„æ€æ‰‹ã€‚ä½ éœ€è¦é‚£ç§å¿ƒè·³åŠ é€Ÿã€è‚¾ä¸Šè…ºç´ é£™å‡çš„æ„Ÿè§‰ï¼Œæ¸©åæ°´å¼çš„äº²å¯†å…³ç³»å¾ˆéš¾è®©ä½ æ»¡è¶³ã€‚å–œæ¬¢å¸¦æœ‰å¼ åŠ›å’Œç´§è¿«æ„Ÿçš„äº’åŠ¨ï¼Œæƒ…ç»ªè¶Šæ¿€çƒˆè¶Šèƒ½æ¿€å‘ä½ ã€‚æœ‰æ—¶å€™äº‰åµä¹‹åçš„å’Œå¥½åè€Œæ¯”å¹³é™æ—¶æ›´æœ‰æ„Ÿè§‰â€”â€”å†²çªå’Œæ¿€æƒ…å¯¹ä½ æ¥è¯´æ˜¯ä¸€ä½“ä¸¤é¢ã€‚' });
            if (hasStar(ziNv, 'å¤©åŒ') || hasStar(ming, 'å¤©åŒ')) styleItems.push({ icon: 'ğŸŒŠ', text: 'æ³¨é‡è¿‡ç¨‹å’Œæ°›å›´ï¼Œæ˜¯å…¸å‹çš„æ…¢çƒ­å‹ã€‚ä½ éœ€è¦è¶³å¤Ÿçš„æƒ…æ„Ÿé“ºå«æ‰èƒ½çœŸæ­£è¿›å…¥çŠ¶æ€ï¼Œè·³è¿‡å‰æˆç›´å¥”ä¸»é¢˜ä¼šè®©ä½ æ„Ÿåˆ°ä¸èˆ’æœç”šè‡³æŠµè§¦ã€‚äº«å—æ•´ä¸ªè¿‡ç¨‹çš„æµåŠ¨æ„Ÿï¼Œä¸æ€¥äºæ±‚æˆã€‚æ°›å›´å¯¹ä½ æä¸ºé‡è¦â€”â€”ç¯å…‰ã€éŸ³ä¹ã€å¯¹æ–¹çš„æƒ…ç»ªçŠ¶æ€ï¼Œè¿™äº›ç»†èŠ‚éƒ½ä¼šç›´æ¥å½±å“ä½ çš„æŠ•å…¥ç¨‹åº¦ã€‚ä½ æœ€äº«å—çš„æ˜¯é‚£ç§å½¼æ­¤éƒ½å®Œå…¨æ”¾æ¾ã€æ²¡æœ‰ä»»ä½•å‹åŠ›çš„äº²å¯†æ—¶åˆ»ã€‚' });
            if (hasStar(ziNv, 'å¤ªé˜´') || hasStar(fuDe, 'å¤ªé˜´')) styleItems.push({ icon: 'ğŸŒ™', text: 'ç»†è…»æ•æ„Ÿï¼Œå¯¹æ°›å›´å’Œæƒ…è°ƒçš„è¦æ±‚å¾ˆé«˜ã€‚ä½ å¯¹è§¦æ„Ÿã€æ¸©åº¦ã€æ°”å‘³è¿™äº›ç»†èŠ‚æä¸ºæ•æ„Ÿï¼Œè½»æŸ”çš„æ¥è§¦æœ‰æ—¶æ¯”æ¿€çƒˆçš„åŠ¨ä½œæ›´èƒ½è§¦åŠ¨ä½ ã€‚å–œæ¬¢å«è“„å†…æ•›çš„è¡¨è¾¾æ–¹å¼ï¼Œä¸å–œæ¬¢å¤ªè¿‡ç²—ç³™æˆ–ç›´ç™½çš„äº’åŠ¨ã€‚ç§å¯†æ„Ÿå¯¹ä½ å¾ˆé‡è¦ï¼Œä½ éœ€è¦æ„Ÿè§‰åˆ°è¿™æ˜¯åªå±äºä½ ä»¬ä¸¤ä¸ªäººçš„ç©ºé—´ï¼Œæ‰èƒ½å®Œå…¨æ”¾å¼€ã€‚æœˆå…‰ã€å¤œæ™šã€å®‰é™çš„ç¯å¢ƒâ€”â€”è¿™äº›æ„è±¡å¯¹ä½ æœ‰å¤©ç„¶çš„å¸å¼•åŠ›ã€‚' });
            if (hasStar(ming, 'ä¸ƒæ€') || hasStar(ziNv, 'ä¸ƒæ€')) styleItems.push({ icon: 'ğŸ—¡ï¸', text: 'å¾æœæ¬²å¼ºï¼Œå–œæ¬¢æœ‰å¼ åŠ›çš„å…³ç³»ã€‚å¹³ç­‰æˆ–ç•¥å¸¦æŒ‘æˆ˜æ„Ÿçš„äº’åŠ¨æœ€èƒ½æ¿€å‘ä½ ï¼Œä½ äº«å—é‚£ç§"èµ¢å¾—"å¯¹æ–¹çš„è¿‡ç¨‹ã€‚å¯¹æ–¹å¦‚æœå¤ªå®¹æ˜“å¾—åˆ°ï¼Œä½ åè€Œä¼šå¤±å»å…´è¶£ï¼›é€‚åº¦çš„é˜»åŠ›å’ŒæŒ‘æˆ˜æ„Ÿè®©ä½ æ›´å…´å¥‹ã€‚ä½ å–œæ¬¢åœ¨äº²å¯†å…³ç³»ä¸­æ„Ÿå—åˆ°è‡ªå·±çš„åŠ›é‡å’Œå½±å“åŠ›ï¼Œè¢«å¯¹æ–¹å®Œå…¨é¡ºä»åè€Œè®©ä½ è§‰å¾—æ— èŠã€‚æœ‰æ—¶å€™ä½ çš„å¾æœæ¬²ä¼šå»¶ä¼¸åˆ°å¿ƒç†å±‚é¢â€”â€”è®©å¯¹æ–¹å¿ƒç”˜æƒ…æ„¿åœ°è‡£æœæ¯”è‚‰ä½“ä¸Šçš„å¾æœæ›´è®©ä½ æ»¡è¶³ã€‚' });
            if (hasStar(ming, 'ç ´å†›') || hasStar(ziNv, 'ç ´å†›')) styleItems.push({ icon: 'ğŸ’¥', text: 'å‹‡äºçªç ´è¾¹ç•Œï¼Œä¸æ‹˜ä¼ ç»Ÿï¼Œè¶Šæ˜¯ç¦å¿Œçš„äº‹è¶Šæœ‰å¸å¼•åŠ›ã€‚ä½ å¯¹"ä¸åº”è¯¥"å’Œ"ä¸å¯ä»¥"æœ‰å¤©ç„¶çš„å¥½å¥‡å¿ƒï¼Œè§„åˆ™å’Œé™åˆ¶å¯¹ä½ æ¥è¯´æ›´åƒæ˜¯æŒ‘æˆ˜è€Œä¸æ˜¯çº¦æŸã€‚å–œæ¬¢æ¢ç´¢å¸¸è§„ä¹‹å¤–çš„ä½“éªŒï¼Œä¸ä»‹æ„å°è¯•å¤§å¤šæ•°äººä¸æ•¢å°è¯•çš„äº‹ã€‚è¿™ç§çªç ´æ„Ÿæœ¬èº«å°±æ˜¯ä½ çš„å…´å¥‹ç‚¹ä¹‹ä¸€â€”â€”ä¸åªæ˜¯ä¸ºäº†ä½“éªŒæœ¬èº«ï¼Œè€Œæ˜¯æ‰“ç ´è¾¹ç•Œçš„é‚£ä¸€åˆ»å¸¦æ¥çš„å¿«æ„Ÿã€‚' });
            if (hasStar(ming, 'ç´«å¾®') || hasStar(fuDe, 'ç´«å¾®')) styleItems.push({ icon: 'ğŸ‘‘', text: 'æ³¨é‡ä»ªå¼æ„Ÿå’Œå°Šä¸¥ï¼Œä¸å–œéšæ„ã€‚ä½ éœ€è¦è¢«è®¤çœŸå¯¹å¾…æ‰èƒ½æ”¾å¼€è‡ªå·±ï¼Œè‰ç‡æˆ–ä¸å°Šé‡çš„æ–¹å¼ä¼šè®©ä½ ç«‹åˆ»å…³é—­ã€‚ä½ å¯¹å“è´¨æœ‰è¦æ±‚â€”â€”ä¸åªæ˜¯ç¯å¢ƒçš„å“è´¨ï¼Œæ›´æ˜¯äº’åŠ¨æœ¬èº«çš„å“è´¨ã€‚ä½ äº«å—è¢«å´‡æ‹œã€è¢«çè§†çš„æ„Ÿè§‰ï¼Œå¯¹æ–¹çš„ç”¨å¿ƒç¨‹åº¦ç›´æ¥å½±å“ä½ çš„æŠ•å…¥ç¨‹åº¦ã€‚æœ‰æ—¶å€™ä½ å†…å¿ƒæ·±å¤„æ¸´æœ›çš„æ˜¯é‚£ç§"è¢«å½“æˆæœ€é‡è¦çš„äºº"çš„æ„Ÿè§‰ï¼Œè¿™æ¯”ä»»ä½•æŠ€å·§éƒ½æ›´èƒ½æ‰“åŠ¨ä½ ã€‚' });
            if (hasStar(fuDe, 'å¤©æ¢') || hasStar(ming, 'å¤©æ¢')) styleItems.push({ icon: 'ğŸ§ ', text: 'ç²¾ç¥å±‚é¢çš„è¿æ¥æ¯”è‚‰ä½“æ›´é‡è¦ï¼Œå¿ƒçµå¥‘åˆæ˜¯ä½ æœ€å¤§çš„å‰ææ¡ä»¶ã€‚ä½ å¾ˆéš¾å’Œä¸€ä¸ªç²¾ç¥ä¸Šä¸å¸å¼•ä½ çš„äººå‘ç”Ÿäº²å¯†å…³ç³»ï¼Œå³ä½¿å¯¹æ–¹å¤–è¡¨å¾ˆå¥½çœ‹ã€‚æ·±åº¦çš„äº¤æµã€è¢«çœŸæ­£ç†è§£çš„æ„Ÿè§‰ï¼Œæ˜¯ä½ æœ€é‡è¦çš„å‰æˆã€‚ä½ äº«å—é‚£ç§"çµé­‚ç›¸é‡"çš„æ„Ÿè§‰ï¼Œè‚‰ä½“çš„ç»“åˆå¯¹ä½ æ¥è¯´æ˜¯ç²¾ç¥è¿æ¥çš„å»¶ä¼¸ï¼Œè€Œä¸æ˜¯ç›®çš„æœ¬èº«ã€‚å¦‚æœå…³ç³»åªåœç•™åœ¨è‚‰ä½“å±‚é¢ï¼Œä½ ä¼šæ„Ÿåˆ°ç©ºæ´å’Œä¸æ»¡è¶³ã€‚' });
            if (hasStar(ziNv, 'å¤©æœº') || hasStar(ming, 'å¤©æœº')) styleItems.push({ icon: 'ğŸ¯', text: 'å–„äºæ£æ‘©å¯¹æ–¹å¿ƒç†ï¼Œæ³¨é‡æŠ€å·§å’Œæ–¹æ³•ã€‚ä½ å–œæ¬¢æœ‰å˜åŒ–å’Œå±‚æ¬¡æ„Ÿçš„ä½“éªŒï¼Œä¸€æˆä¸å˜çš„æ–¹å¼å¾ˆå¿«å°±ä¼šè®©ä½ å¤±å»å…´è¶£ã€‚ä½ ä¼šä¸»åŠ¨ç ”ç©¶å’Œå­¦ä¹ ï¼Œäº«å—"æŠŠäº‹æƒ…åšå¥½"çš„æˆå°±æ„Ÿã€‚å¯¹æ–¹çš„ååº”å’ŒçŠ¶æ€æ˜¯ä½ æœ€é‡è¦çš„å‚è€ƒâ€”â€”ä½ ä¼šæ ¹æ®å¯¹æ–¹çš„å›åº”å®æ—¶è°ƒæ•´ï¼Œè¿™è®©ä½ æˆä¸ºä¸€ä¸ªå¾ˆæœ‰æ„ŸçŸ¥åŠ›çš„ä¼´ä¾£ã€‚ä½ çš„è„‘å­åœ¨äº²å¯†å…³ç³»ä¸­ä¹Ÿä¸ä¼šå®Œå…¨åœä¸‹æ¥ï¼Œè¿™æ—¢æ˜¯ä¼˜åŠ¿ä¹Ÿå¯èƒ½æ˜¯éšœç¢ã€‚' });
            if (hasStar(ziNv, 'æ­¦æ›²') || hasStar(jiE, 'æ­¦æ›²')) styleItems.push({ icon: 'ğŸ’ª', text: 'ç›´æ¥åŠ¡å®ï¼Œä¸å–œæ¬¢ç»•å¼¯å­ã€‚ä½ çš„ä½“åŠ›å……æ²›ï¼Œè¡ŒåŠ¨åŠ›å¼ºï¼ŒæŒä¹…åŠ›å¥½ï¼Œä¸å–œæ¬¢æ‹–æ‹–æ‹‰æ‹‰ã€‚ä½ æ›´çœ‹é‡å®é™…çš„æ„Ÿå—è€Œä¸æ˜¯æ°›å›´çš„è¥é€ ï¼Œæœ‰æ—¶å€™ä¼šè§‰å¾—å¤ªå¤šçš„"å‰æˆ"æ˜¯åœ¨æµªè´¹æ—¶é—´ã€‚ä½ çš„ç›´æ¥æœ‰æ—¶å€™ä¼šè®©å¯¹æ–¹æ„Ÿåˆ°çªç„¶ï¼Œä½†ä¹Ÿæœ‰äººéå¸¸æ¬£èµè¿™ç§ä¸åšä½œçš„é£æ ¼ã€‚ä½ åœ¨äº²å¯†å…³ç³»ä¸­çš„è¡¨ç°å¾€å¾€æ¯”ä½ çš„è¯­è¨€è¡¨è¾¾æ›´æœ‰åŠ›â€”â€”è¡ŒåŠ¨æ˜¯ä½ æœ€è‡ªç„¶çš„è¡¨è¾¾æ–¹å¼ã€‚' });
            if (hasStar(ming, 'å¤©åºœ') || hasStar(ziNv, 'å¤©åºœ')) styleItems.push({ icon: 'ğŸ›ï¸', text: 'ç¨³é‡ä¿å®ˆï¼Œæ³¨é‡å®‰å…¨æ„Ÿã€‚ä½ åå¥½ç†Ÿæ‚‰å›ºå®šçš„æ¨¡å¼ï¼Œä¸è½»æ˜“å°è¯•æ–°äº‹ç‰©ï¼Œä½†åœ¨å»ºç«‹äº†è¶³å¤Ÿä¿¡ä»»çš„å…³ç³»é‡Œä¼šé€æ¸æ”¾å¼€ã€‚ä½ éœ€è¦æ„Ÿåˆ°ç»å¯¹å®‰å…¨æ‰èƒ½çœŸæ­£æŠ•å…¥ï¼Œä»»ä½•ä¸ç¡®å®šæ„Ÿéƒ½ä¼šè®©ä½ æ”¶ç¼©ã€‚ä½ çš„äº²å¯†å…³ç³»å¾€å¾€éœ€è¦æ—¶é—´æ¥å»ºç«‹ï¼Œä½†ä¸€æ—¦å»ºç«‹å°±ä¼šéå¸¸ç¨³å›ºå’Œæ·±å…¥ã€‚ä½ ä¸è¿½æ±‚åˆºæ¿€ï¼Œä½†ä½ èƒ½ç»™ä¼´ä¾£å¸¦æ¥ä¸€ç§è¸å®çš„ã€è¢«æ¥çº³çš„æ„Ÿè§‰ã€‚' });
            if (hasStar(ziNv, 'å·¨é—¨') || hasStar(ming, 'å·¨é—¨')) styleItems.push({ icon: 'ğŸ—£ï¸', text: 'å†…å¿ƒæ·±å¤„æ¬²æœ›ä¸°å¯Œï¼Œä½†ä¸è½»æ˜“è¡¨éœ²ã€‚ä½ éœ€è¦å……åˆ†çš„ä¿¡ä»»å’Œå®‰å…¨æ„Ÿæ‰èƒ½è¯´å‡ºè‡ªå·±çœŸæ­£æƒ³è¦ä»€ä¹ˆï¼Œåœ¨ä¸å¤Ÿç†Ÿæ‚‰çš„å…³ç³»é‡Œä½ ä¼šå‹æŠ‘è‡ªå·±çš„éœ€æ±‚ã€‚è¯­è¨€å¯¹ä½ å¾ˆé‡è¦â€”â€”å¯¹æ–¹è¯´çš„è¯ã€ç”¨çš„è¯ï¼Œéƒ½ä¼šç›´æ¥å½±å“ä½ çš„çŠ¶æ€ã€‚ä½ å…¶å®æœ‰å¾ˆå¤šæƒ³æ³•å’Œå¹»æƒ³ï¼Œåªæ˜¯å¾ˆå°‘ä¸»åŠ¨å¼€å£ï¼Œç­‰å¾…å¯¹æ–¹æ¥å‘ç°å’Œå¼•å¯¼ä½ ã€‚' });
            if (styleItems.length === 0) styleItems.push({ icon: 'â˜¯ï¸', text: 'åå¥½å¹³å’Œç¨³å®šçš„äº²å¯†å…³ç³»ï¼Œä¸è¿½æ±‚æç«¯ä½“éªŒï¼Œæ³¨é‡èˆ’é€‚å’Œå®‰å…¨æ„Ÿã€‚ä½ ä¸éœ€è¦å¤ªå¤šåˆºæ¿€ï¼Œäº«å—é‚£ç§è‡ªç„¶æµåŠ¨ã€æ²¡æœ‰å‹åŠ›çš„äº²å¯†çŠ¶æ€ã€‚å¯¹ä½ æ¥è¯´ï¼Œæœ€å¥½çš„äº²å¯†å…³ç³»æ˜¯è®©åŒæ–¹éƒ½æ„Ÿåˆ°æ”¾æ¾å’Œè¢«æ¥çº³çš„ï¼Œè€Œä¸æ˜¯å……æ»¡å¼ åŠ›å’ŒæŒ‘æˆ˜çš„ã€‚' });

            // â”€â”€ ä¼´ä¾£åå¥½ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
            const partnerItems = [];
            if (hasStar(fuQi, 'è´ªç‹¼')) partnerItems.push({ trait: 'æœ‰é­…åŠ›ã€ä¼šæ’©äºº', desc: 'ä½ éœ€è¦ä¸€ä¸ªèƒ½æŒç»­ç»™ä½ å¸¦æ¥æ–°é²œæ„Ÿçš„ä¼´ä¾£ã€‚å¯¹æ–¹è¦æœ‰è‡ªå·±çš„é­…åŠ›å’Œå¸å¼•åŠ›ï¼Œä¼šä¸»åŠ¨åˆ¶é€ æƒŠå–œï¼Œè®©ä½ æ°¸è¿œçŒœä¸é€ä¸‹ä¸€æ­¥ã€‚å¤ªè¿‡å¹³æ·¡æˆ–å¯é¢„æµ‹çš„äººå¾ˆéš¾é•¿æœŸå¸å¼•ä½ ã€‚' });
            if (hasStar(fuQi, 'å»‰è´')) partnerItems.push({ trait: 'çƒ­æƒ…ä¸»åŠ¨ï¼Œæ„Ÿæƒ…ç‚½çƒˆ', desc: 'ä½ éœ€è¦ä¸€ä¸ªèƒ½ç‚¹ç‡ƒä½ çš„äººã€‚å¯¹æ–¹è¦æœ‰å¼ºçƒˆçš„æƒ…æ„Ÿè¡¨è¾¾ï¼Œä¸å‹æŠ‘ã€ä¸å«ç³Šï¼Œæ•¢äºç›´æ¥è¡¨è¾¾æ¬²æœ›å’Œéœ€æ±‚ã€‚å†·æ·¡æˆ–è¢«åŠ¨çš„ä¼´ä¾£ä¼šè®©ä½ æ„Ÿåˆ°æ— èŠç”šè‡³æ²®ä¸§ã€‚' });
            if (hasStar(fuQi, 'ä¸ƒæ€')) partnerItems.push({ trait: 'æœ‰ä¸ªæ€§ã€æœ‰ä¸»è§', desc: 'ä½ ä¸å–œæ¬¢ä¸€å‘³é¡ºä»ä½ çš„äººï¼Œéœ€è¦å¯¹æ–¹æœ‰è‡ªå·±çš„ç«‹åœºå’Œä¸ªæ€§ã€‚é€‚åº¦çš„å¼ åŠ›å’Œæ‘©æ“¦åè€Œè®©ä½ æ›´æœ‰å…´è¶£ï¼Œå®Œå…¨é¡ºä»çš„ä¼´ä¾£ä¼šè®©ä½ å¤±å»å¾æœçš„æ¬²æœ›ã€‚' });
            if (hasStar(fuQi, 'ç ´å†›')) partnerItems.push({ trait: 'æ•¢äºçªç ´ï¼Œä¸å¢¨å®ˆæˆè§„', desc: 'ä½ éœ€è¦ä¸€ä¸ªæ„¿æ„å’Œä½ ä¸€èµ·æ¢ç´¢è¾¹ç•Œçš„ä¼´ä¾£ï¼Œå¯¹æ–¹è¦æœ‰å†’é™©ç²¾ç¥ï¼Œä¸ä¼šå› ä¸º"ä¸æ­£å¸¸"å°±é€€ç¼©ã€‚èƒ½å¸¦ä½ å»ä½ è‡ªå·±ä¸æ•¢å»çš„åœ°æ–¹ï¼Œæˆ–è€…æ„¿æ„è·Ÿç€ä½ ä¸€èµ·çªç ´ã€‚' });
            if (hasStar(fuQi, 'ç´«å¾®')) partnerItems.push({ trait: 'æœ‰æ°”è´¨ã€æœ‰åœ°ä½æ„Ÿ', desc: 'ä½ å¯¹ä¼´ä¾£çš„"æ¡£æ¬¡"æœ‰è¦æ±‚ï¼Œä¸åªæ˜¯å¤–è¡¨ï¼Œæ›´æ˜¯æ°”è´¨ã€è°ˆåã€ç¤¾ä¼šåœ°ä½å¸¦æ¥çš„é‚£ç§æ„Ÿè§‰ã€‚ä½ éœ€è¦æ„Ÿåˆ°å¯¹æ–¹æ˜¯å€¼å¾—ä½ çš„ï¼Œé…ä¸ä¸Šä½ çš„äººå¾ˆéš¾è®©ä½ çœŸæ­£æŠ•å…¥ã€‚' });
            if (hasStar(fuQi, 'å¤©åŒ')) partnerItems.push({ trait: 'æ¸©æŸ”éšå’Œï¼Œè®©ä½ æ”¾æ¾', desc: 'ä½ éœ€è¦ä¸€ä¸ªèƒ½è®©ä½ å®Œå…¨æ”¾æ¾çš„ä¼´ä¾£ï¼Œä¸ç»™ä½ å‹åŠ›ï¼Œä¸è®©ä½ è§‰å¾—éœ€è¦è¡¨æ¼”ã€‚å¯¹æ–¹çš„æ¸©æŸ”å’ŒåŒ…å®¹æ˜¯ä½ æœ€å¤§çš„å®‰å…¨æ„Ÿæ¥æºï¼Œåœ¨è¿™æ ·çš„å…³ç³»é‡Œä½ æ‰èƒ½çœŸæ­£æ‰“å¼€è‡ªå·±ã€‚' });
            if (hasStar(fuQi, 'å¤ªé˜´')) partnerItems.push({ trait: 'ç»†è…»ä½“è´´ï¼Œæƒ…æ„Ÿæ·±åº¦å¥½', desc: 'ä½ éœ€è¦ä¸€ä¸ªèƒ½æ„Ÿå—åˆ°ä½ ç»†å¾®å˜åŒ–çš„ä¼´ä¾£ï¼Œå–„äºè§‚å¯Ÿã€å–„äºå›åº”ï¼Œä¸éœ€è¦ä½ è¯´å‡ºå£å°±èƒ½çŸ¥é“ä½ éœ€è¦ä»€ä¹ˆã€‚æƒ…æ„Ÿæ·±åº¦å¯¹ä½ æ¥è¯´æ¯”æ¿€æƒ…æ›´é‡è¦ï¼Œä½ éœ€è¦è¢«çœŸæ­£çœ‹è§ã€‚' });
            if (hasStar(fuQi, 'å¤©æœº')) partnerItems.push({ trait: 'èªæ˜æœ‰è¶£ï¼Œç²¾ç¥å…±é¸£', desc: 'ä½ éœ€è¦ä¸€ä¸ªèƒ½å’Œä½ åœ¨ç²¾ç¥å±‚é¢å¯¹è¯çš„ä¼´ä¾£ï¼Œèªæ˜ã€æœ‰æƒ³æ³•ã€èƒ½è®©ä½ åœ¨åºŠä¸Šå’ŒåºŠä¸‹éƒ½æ„Ÿåˆ°è¢«åˆºæ¿€ã€‚æ— èŠçš„äººå³ä½¿å¤–è¡¨å†å¥½çœ‹ä¹Ÿå¾ˆéš¾é•¿æœŸå¸å¼•ä½ ã€‚' });
            if (hasStar(fuQi, 'å¤ªé˜³')) partnerItems.push({ trait: 'é˜³å…‰ç§¯æï¼Œç»™äºˆæ„Ÿå¼º', desc: 'ä½ éœ€è¦ä¸€ä¸ªä¸»åŠ¨ä»˜å‡ºã€è®©ä½ æ„Ÿåˆ°è¢«çè§†çš„ä¼´ä¾£ã€‚å¯¹æ–¹è¦æœ‰èƒ½é‡ï¼Œèƒ½å¸¦åŠ¨ä½ çš„æƒ…ç»ªï¼Œè®©ä½ åœ¨å…³ç³»é‡Œæ„Ÿåˆ°è¢«æ»‹å…»è€Œä¸æ˜¯è¢«æ¶ˆè€—ã€‚' });
            if (hasStar(fuQi, 'æ­¦æ›²')) partnerItems.push({ trait: 'æœ‰èƒ½åŠ›ã€é è°±è¸å®', desc: 'ä½ éœ€è¦ä¸€ä¸ªæœ‰å®åŠ›çš„ä¼´ä¾£ï¼Œä¸åªæ˜¯ç»æµä¸Šï¼Œæ›´æ˜¯è¡ŒåŠ¨åŠ›å’Œæ‰§è¡ŒåŠ›ä¸Šã€‚è¯´åˆ°åšåˆ°ï¼Œä¸æ‹–æ³¥å¸¦æ°´ï¼Œè¿™ç§è¸å®æ„Ÿè®©ä½ æœ‰å®‰å…¨æ„Ÿï¼Œä¹Ÿè®©ä½ æ›´æ„¿æ„æŠ•å…¥ã€‚' });
            if (hasStar(fuQi, 'å¤©åºœ')) partnerItems.push({ trait: 'ç¨³é‡å¯é ï¼Œç»™ä½ å®‰å…¨æ„Ÿ', desc: 'ä½ éœ€è¦ä¸€ä¸ªç¨³å®šçš„ä¼´ä¾£ï¼Œä¸ä¼šè®©ä½ æ„Ÿåˆ°ä¸ç¡®å®šæˆ–ç„¦è™‘ã€‚å¯¹æ–¹çš„ç¨³é‡å’Œå¯é æ˜¯ä½ æœ€é‡è¦çš„éœ€æ±‚ï¼Œåœ¨è¿™ç§å®‰å…¨æ„Ÿçš„åŸºç¡€ä¸Šä½ æ‰èƒ½çœŸæ­£æ”¾å¼€ã€‚' });
            if (hasStar(fuQi, 'å¤©æ¢')) partnerItems.push({ trait: 'æœ‰è´£ä»»æ„Ÿï¼Œé‡è§†ç²¾ç¥å¥‘åˆ', desc: 'ä½ éœ€è¦ä¸€ä¸ªæŠŠä½ æ”¾åœ¨å¿ƒä¸Šã€æ„¿æ„ä¸ºä½ æ‰¿æ‹…è´£ä»»çš„ä¼´ä¾£ã€‚ç²¾ç¥å±‚é¢çš„å¥‘åˆå¯¹ä½ æ¥è¯´æ˜¯å‰æï¼Œå¯¹æ–¹è¦èƒ½ç†è§£ä½ ã€å°Šé‡ä½ ï¼Œè€Œä¸åªæ˜¯è¢«ä½ çš„å¤–è¡¨å¸å¼•ã€‚' });
            if (hasStar(fuQi, 'å·¨é—¨')) partnerItems.push({ trait: 'å–„äºè¡¨è¾¾ï¼Œæ²Ÿé€šèƒ½åŠ›å¼º', desc: 'ä½ éœ€è¦ä¸€ä¸ªèƒ½è¯´å‡ºå£çš„ä¼´ä¾£ï¼Œä¸ç®¡æ˜¯è¡¨è¾¾æ¬²æœ›ã€è¡¨è¾¾æ„Ÿå—è¿˜æ˜¯è¡¨è¾¾éœ€æ±‚ã€‚æ²‰é»˜å¯¡è¨€çš„äººè®©ä½ æ„Ÿåˆ°ä¸å®‰ï¼Œä½ éœ€è¦è¯­è¨€ä¸Šçš„äº’åŠ¨æ¥ç¡®è®¤å…³ç³»çš„å­˜åœ¨ã€‚' });
            if (hasStar(fuQi, 'å¤©ç›¸')) partnerItems.push({ trait: 'é…åˆåº¦é«˜ï¼Œå–„äºè¿åˆ', desc: 'ä½ éœ€è¦ä¸€ä¸ªæ„¿æ„é…åˆä½ ã€ä»¥ä½ ä¸ºä¸­å¿ƒçš„ä¼´ä¾£ã€‚å¯¹æ–¹çš„é¡ºä»å’Œè¿åˆè®©ä½ æ„Ÿåˆ°è¢«é‡è§†ï¼Œä½ äº«å—é‚£ç§"å¯¹æ–¹ä¸ºäº†ä½ è€Œè°ƒæ•´è‡ªå·±"çš„æ„Ÿè§‰ã€‚' });
            if (partnerItems.length === 0) partnerItems.push({ trait: 'æ•´ä½“æ„Ÿè§‰å’Œç›¸å¤„èˆ’é€‚åº¦', desc: 'ä½ å¯¹ä¼´ä¾£æ²¡æœ‰ç‰¹åˆ«å¼ºçƒˆçš„ç±»å‹åå¥½ï¼Œæ›´çœ‹é‡æ•´ä½“çš„åŒ–å­¦ååº”å’Œç›¸å¤„æ˜¯å¦è‡ªç„¶ã€‚ä½ ä¸ä¼šå› ä¸ºå¯¹æ–¹ç¬¦åˆæŸä¸ªæ ‡å‡†å°±æŠ•å…¥ï¼Œè€Œæ˜¯éœ€è¦é‚£ç§è¯´ä¸æ¸…æ¥šä½†æ„Ÿè§‰å¯¹äº†çš„æ„Ÿè§‰ã€‚' });

            // â”€â”€ å››åŒ–åŠ æˆ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
            const bonusItems = [];
            if (hasSihua(ziNv, 'åŒ–ç¦„')) bonusItems.push('æ€§ç”Ÿæ´»æ•´ä½“å’Œè°ï¼Œå®¹æ˜“è·å¾—æ»¡è¶³æ„Ÿï¼Œæ˜¯å¤©ç”Ÿçš„äº«ä¹è€…ã€‚ä½ ä¸éœ€è¦å¤ªå¤šæ¡ä»¶å°±èƒ½è¿›å…¥çŠ¶æ€ï¼Œèº«ä½“å¯¹æ„‰æ‚¦çš„æ¥å—åº¦å¾ˆé«˜ï¼Œå¾ˆå°‘æœ‰"æ€ä¹ˆéƒ½ä¸å¯¹"çš„æƒ…å†µã€‚è¿™æ˜¯ä¸€ç§éš¾å¾—çš„å¤©èµ‹ï¼Œå¾ˆå¤šäººç»ˆå…¶ä¸€ç”Ÿéƒ½åœ¨å¯»æ‰¾ä½ å¤©ç”Ÿå°±æœ‰çš„é‚£ç§æ”¾æ¾æ„Ÿã€‚');
            if (hasSihua(ziNv, 'åŒ–æƒ')) bonusItems.push('åœ¨äº²å¯†å…³ç³»ä¸­æŒæ§æ¬²å¾ˆå¼ºï¼Œå–œæ¬¢ä¸»å¯¼ä¸€åˆ‡ç»†èŠ‚â€”â€”æ—¶é—´ã€åœ°ç‚¹ã€æ–¹å¼ã€èŠ‚å¥ã€‚è¿™ç§æŒæ§æ¬²ä¸æ˜¯æ§åˆ¶æ¬²ï¼Œè€Œæ˜¯ä½ å¯¹å“è´¨çš„è¿½æ±‚ï¼šä½ çŸ¥é“è‡ªå·±æƒ³è¦ä»€ä¹ˆï¼Œä¹Ÿæœ‰èƒ½åŠ›å»å®ç°å®ƒã€‚å¯¹æ–¹å¦‚æœèƒ½æ¥å—ä½ çš„ä¸»å¯¼ï¼Œå…³ç³»ä¼šéå¸¸é¡ºç•…ï¼›å¦‚æœå¯¹æ–¹ä¹Ÿæ˜¯å¼ºåŠ¿å‹ï¼Œå¯èƒ½éœ€è¦åå•†ç©ºé—´ã€‚');
            if (hasSihua(jiE, 'åŒ–ç¦„')) bonusItems.push('ä½“è´¨å¥½ï¼Œç²¾åŠ›å……æ²›ï¼Œèº«ä½“çŠ¶æ€å¯¹äº²å¯†å…³ç³»æœ‰å¤©ç„¶åŠ æŒã€‚ä½ ä¸å®¹æ˜“ç–²æƒ«ï¼Œæ¢å¤å¿«ï¼ŒçŠ¶æ€ç¨³å®šï¼Œè¿™è®©ä½ åœ¨äº²å¯†å…³ç³»ä¸­æœ‰æŒç»­çš„èƒ½é‡è¾“å‡ºã€‚ä½ çš„èº«ä½“æœ¬èº«å°±æ˜¯ä½ çš„ä¼˜åŠ¿ï¼Œå¥½å¥½ä¿å…»ï¼Œè¿™ç§å¤©èµ‹ä¼šä¸€ç›´é™ªç€ä½ ã€‚');
            if (hasSihua(jiE, 'åŒ–æƒ')) bonusItems.push('çˆ†å‘åŠ›å¼ºï¼Œä½“èƒ½æ—ºç››ï¼Œè¡ŒåŠ¨åŠ›åè¶³ã€‚ä½ åœ¨äº²å¯†å…³ç³»ä¸­çš„è¡¨ç°å¾€å¾€è¶…å‡ºå¯¹æ–¹çš„é¢„æœŸï¼Œå¼ºåº¦å’ŒæŒç»­æ€§éƒ½å¾ˆå¥½ã€‚è¿™ç§ä½“èƒ½ä¸Šçš„ä¼˜åŠ¿è®©ä½ åœ¨éœ€è¦çš„æ—¶å€™èƒ½å®Œå…¨æŠ•å…¥ï¼Œä¸ä¼šå› ä¸ºä½“åŠ›é—®é¢˜è€Œæ‰“æŠ˜æ‰£ã€‚');
            if (hasSihua(fuDe, 'åŒ–ç¦„')) bonusItems.push('ç²¾ç¥å±‚é¢å¯Œè¶³ï¼Œå†…å¿ƒæ„‰æ‚¦ï¼Œäº«å—ç”Ÿæ´»çš„èƒ½åŠ›å¼ºã€‚ä½ ä¸å®¹æ˜“é™·å…¥æ€§æ–¹é¢çš„ç„¦è™‘æˆ–è‡ªæˆ‘æ€€ç–‘ï¼Œå¯¹è‡ªå·±çš„æ¬²æœ›å’Œéœ€æ±‚æœ‰æ¯”è¾ƒå¥åº·çš„æ€åº¦ã€‚è¿™ç§å†…å¿ƒçš„å¯Œè¶³æ„Ÿè®©ä½ åœ¨äº²å¯†å…³ç³»ä¸­æ›´è‡ªåœ¨ï¼Œä¹Ÿæ›´èƒ½ç»™å¯¹æ–¹å¸¦æ¥è½»æ¾çš„æ„Ÿè§‰ã€‚');
            if (hasSihua(ming, 'åŒ–æƒ')) bonusItems.push('ä¸ªæ€§å¼ºåŠ¿ï¼Œè‡ªä¸»æ„è¯†å¼ºï¼Œä¸å–œæ¬¢è¢«å®‰æ’ã€‚ä½ æ¸…æ¥šåœ°çŸ¥é“è‡ªå·±æƒ³è¦ä»€ä¹ˆï¼Œä¹Ÿæœ‰å‹‡æ°”å»è¡¨è¾¾å’Œäº‰å–ã€‚åœ¨äº²å¯†å…³ç³»ä¸­ï¼Œä½ ä¸ä¼šå§”å±ˆè‡ªå·±å»è¿åˆå¯¹æ–¹ï¼Œè¿™ç§è‡ªæˆ‘æ„è¯†æ˜¯å¥åº·å…³ç³»çš„åŸºç¡€ã€‚');
            if (hasSihua(fuQi, 'åŒ–ç¦„')) bonusItems.push('å¤«å¦»å®«åŒ–ç¦„ï¼Œæ„Ÿæƒ…ç”Ÿæ´»æ•´ä½“é¡ºé‚ï¼Œå®¹æ˜“é‡åˆ°ä¸ä½ å¥‘åˆçš„ä¼´ä¾£ã€‚ä½ åœ¨äº²å¯†å…³ç³»ä¸­çš„è¿æ°”æ¯”è¾ƒå¥½ï¼Œä¸éœ€è¦å¤ªè´¹åŠ›å°±èƒ½æ‰¾åˆ°æ„Ÿè§‰å¯¹çš„äººã€‚çæƒœè¿™ç§ç¼˜åˆ†ï¼Œä¸è¦å› ä¸ºå¤ªå®¹æ˜“å¾—åˆ°è€Œä¸çæƒœã€‚');

            // â”€â”€ æ³¨æ„äº‹é¡¹ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
            const cautionItems = [];
            if (hasSihua(ziNv, 'åŒ–å¿Œ')) cautionItems.push('åœ¨äº²å¯†å…³ç³»ä¸­å¯èƒ½å­˜åœ¨æŸäº›å¿ƒç†éšœç¢æˆ–ä¸é¡ºï¼Œè¿™ä¸æ˜¯ä½ çš„é”™ï¼Œè€Œæ˜¯éœ€è¦æ›´å¤šæ—¶é—´å’Œè€å¿ƒå»è§£å¼€çš„ç»“ã€‚å¯èƒ½æ˜¯è¿‡å»çš„æŸæ®µç»å†ç•™ä¸‹äº†é˜´å½±ï¼Œä¹Ÿå¯èƒ½æ˜¯å¯¹è‡ªå·±çš„æŸäº›æ¬²æœ›æ„Ÿåˆ°ç¾è€»æˆ–ææƒ§ã€‚å»ºè®®åœ¨å®‰å…¨çš„å…³ç³»é‡Œæ…¢æ…¢æ¢ç´¢ï¼Œä¸è¦å¼ºè¿«è‡ªå·±ï¼Œä¹Ÿä¸è¦å› ä¸º"åšä¸åˆ°"è€Œè‡ªè´£ã€‚');
            if (hasSihua(jiE, 'åŒ–å¿Œ')) cautionItems.push('èº«ä½“æˆ–æƒ…ç»ªçŠ¶æ€å®¹æ˜“å½±å“äº²å¯†å…³ç³»çš„è¡¨ç°ã€‚ä½ å¯èƒ½ä¼šåœ¨å‹åŠ›å¤§ã€ç¡çœ ä¸è¶³æˆ–æƒ…ç»ªä½è½æ—¶å®Œå…¨æä¸èµ·å…´è¶£ï¼Œè€Œåœ¨çŠ¶æ€å¥½çš„æ—¶å€™åˆéå¸¸æŠ•å…¥â€”â€”è¿™ç§è½å·®å¯èƒ½è®©ä¼´ä¾£æ„Ÿåˆ°å›°æƒ‘ã€‚å­¦ä¼šè¯†åˆ«è‡ªå·±çš„çŠ¶æ€ï¼Œåœ¨ä¸å¯¹çš„æ—¶å€™ä¸è¦å‹‰å¼ºï¼Œä¹Ÿè¦å­¦ä¼šæå‰å’Œä¼´ä¾£æ²Ÿé€šã€‚');
            if (hasSihua(ming, 'åŒ–å¿Œ')) cautionItems.push('æ•´ä½“è¿åŠ¿æœ‰é˜»æ»æ„Ÿï¼Œåœ¨äº²å¯†å…³ç³»ä¸­å®¹æ˜“é‡åˆ°æŒ«æŠ˜æˆ–ä¸é¡ºã€‚å¯èƒ½æ˜¯æ—¶æœºä¸å¯¹ï¼Œå¯èƒ½æ˜¯é‡åˆ°çš„äººä¸åˆé€‚ï¼Œä¹Ÿå¯èƒ½æ˜¯è‡ªå·±å†…å¿ƒæœ‰æŸäº›æœªè§£å†³çš„è¯¾é¢˜åœ¨é˜»ç¢ä½ ã€‚ä¸è¦æŠŠæ¯ä¸€æ¬¡ä¸é¡ºéƒ½å½’å’äºè‡ªå·±ï¼Œä½†ä¹Ÿå€¼å¾—è®¤çœŸåæ€æ˜¯å¦æœ‰æŸäº›æ¨¡å¼åœ¨é‡å¤ã€‚å¿…è¦æ—¶å¯»æ±‚ä¸“ä¸šæ”¯æŒæ˜¯æ˜æ™ºçš„é€‰æ‹©ã€‚');
            if (hasSihua(fuDe, 'åŒ–å¿Œ')) cautionItems.push('å†…å¿ƒä¸æ˜“æ»¡è¶³ï¼Œç²¾ç¥å±‚é¢æœ‰è¾ƒå¤šçƒ¦æ¼ï¼Œå®¹æ˜“åœ¨å…³ç³»ä¸­æ„Ÿåˆ°ç©ºè™šæˆ–"è¿˜ä¸å¤Ÿ"ã€‚ä½ å¯èƒ½ä¼šåœ¨å¾—åˆ°ä¹‹åç«‹åˆ»å¼€å§‹å¯»æ‰¾ä¸‹ä¸€ä¸ªç›®æ ‡ï¼Œæˆ–è€…æ€»è§‰å¾—ç°åœ¨çš„å…³ç³»ç¼ºå°‘ä»€ä¹ˆã€‚è¿™ç§ä¸æ»¡è¶³æ„Ÿçš„æ ¹æºå¾€å¾€ä¸åœ¨ä¼´ä¾£ï¼Œè€Œåœ¨ä½ è‡ªå·±å†…å¿ƒæ·±å¤„çš„æŸç§ç¼ºå¤±ã€‚å­¦ä¼šåœ¨å½“ä¸‹æ‰¾åˆ°æ»¡è¶³æ„Ÿï¼Œè€Œä¸æ˜¯æ°¸è¿œåœ¨è¿½æ±‚"æ›´å¥½çš„"ã€‚');

            // â”€â”€ BDSM å€¾å‘æ¨æµ‹ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
            // Dom/Sub å€¾å‘
            let domScore = 0, subScore = 0;
            // Dom å€¾å‘åˆ¤æ–­ï¼ˆä¸»è¦çœ‹å‘½å®«ï¼‰
            if (hasStar(ming, 'ä¸ƒæ€')) domScore += 3;
            if (hasStar(ming, 'ç´«å¾®')) domScore += 2;
            if (hasStar(ming, 'å»‰è´')) domScore += 1.5;
            if (hasStar(ming, 'ç ´å†›')) domScore += 1;
            if (hasStar(ming, 'æ­¦æ›²')) domScore += 1;
            if (hasStar(ming, 'å¤ªé˜³') && !hasSihua(ming, 'åŒ–å¿Œ')) domScore += 1;  // å¤ªé˜³åŒ–å¿Œä¸ç®—Dom
            if (hasQuan && !hasSihua(ming, 'åŒ–å¿Œ')) domScore += 1.5;

            // Sub å€¾å‘åˆ¤æ–­ï¼ˆå¢åŠ æ›´å¤šå› ç´ ï¼‰
            if (hasStar(ming, 'å¤©ç›¸')) subScore += 2.5;
            if (hasStar(ming, 'å¤©åŒ')) subScore += 2.5;
            if (hasStar(ming, 'å¤ªé˜´')) subScore += 2;
            if (hasStar(ming, 'å¤©æ¢')) subScore += 1.5;
            if (hasStar(ming, 'å¤©æœº')) subScore += 1;
            if (hasStar(ming, 'å¤ªé˜³') && hasSihua(ming, 'åŒ–å¿Œ')) subScore += 3;  // å¤ªé˜³åŒ–å¿Œï¼šå¼ºSub
            if (hasStar(ming, 'å·¨é—¨')) subScore += 1.5;  // å·¨é—¨ï¼šå†…å¿ƒä¸°å¯Œä½†ä¸ä¸»å¯¼

            // å­å¥³å®«ï¼šä¸ƒæ€åœ¨å­å¥³å®«ä»£è¡¨"å–œæ¬¢è¢«å¾æœ"è€Œéå¾æœæ¬²
            if (hasStar(ziNv, 'ä¸ƒæ€')) subScore += 2;  // æ”¹ä¸ºSubå€¾å‘
            if (hasStar(ziNv, 'å»‰è´')) subScore += 1.5;  // å»‰è´åœ¨å­å¥³å®«ï¼šæ¿€æƒ…ä½†ä¸ä¸€å®šä¸»å¯¼
            if (hasStar(ziNv, 'ç ´å†›')) subScore += 1;
            if (hasStar(ziNv, 'å¤©ç›¸')) subScore += 2;
            if (hasStar(ziNv, 'å¤ªé˜´')) subScore += 2;
            if (hasStar(ziNv, 'å¤©åŒ')) subScore += 1.5;
            if (hasStar(ziNv, 'è´ªç‹¼')) subScore += 1.5;

            // ç¦å¾·å®«
            if (hasStar(fuDe, 'è´ªç‹¼')) subScore += 1;
            if (hasStar(fuDe, 'å¤©åŒ')) subScore += 1.5;
            if (hasStar(fuDe, 'å¤ªé˜´')) subScore += 1;
            if (hasStar(fuDe, 'å¤©æœº')) subScore += 1;

            // ç–¾å„å®«ï¼šå»‰è´å¤©ç›¸ç»„åˆ â†’ å¼ºSubå€¾å‘
            if (hasStar(jiE, 'å»‰è´') && hasStar(jiE, 'å¤©ç›¸')) subScore += 2;
            if (hasStar(jiE, 'å¤©ç›¸')) subScore += 1.5;

            // åŒ–å¿Œå¢åŠ Subå€¾å‘
            if (hasSihua(ming, 'åŒ–å¿Œ')) subScore += 2.5;
            if (hasSihua(ziNv, 'åŒ–å¿Œ')) subScore += 1.5;
            if (hasSihua(fuDe, 'åŒ–å¿Œ')) subScore += 1;
            if (hasSihua(jiE, 'åŒ–å¿Œ')) subScore += 1;

            let bdsmRole, bdsmRoleDesc;
            const total = domScore + subScore;
            const domRatio = total > 0 ? domScore / total : 0.5;

            if (domRatio >= 0.65) {  // ä»0.7é™ä½åˆ°0.65
                bdsmRole = 'Dom ä¸»å¯¼';
                bdsmRoleDesc = 'ä½ æœ‰å¼ºçƒˆçš„æ”¯é…æ¬²ï¼Œäº«å—æŒæ§å¯¹æ–¹çš„æ„Ÿè§‰ï¼Œæ˜¯å¤©ç„¶çš„ Dom ä½“è´¨ã€‚ä½ å–œæ¬¢è®¾å®šè§„åˆ™ã€å†³å®šèŠ‚å¥ã€è§‚å¯Ÿå¯¹æ–¹åœ¨ä½ æŒæ§ä¸‹çš„ååº”â€”â€”è¿™ç§æƒåŠ›æ„Ÿæœ¬èº«å°±æ˜¯ä½ æœ€å¤§çš„å…´å¥‹ç‚¹ã€‚ä½ ä¸éœ€è¦å¯¹æ–¹å®Œå…¨é¡ºä»ï¼Œä½†ä½ éœ€è¦æ„Ÿå—åˆ°è‡ªå·±æ˜¯ä¸»å¯¼è€…ã€‚åœ¨ BDSM å…³ç³»ä¸­ï¼Œä½ ä¼šæ˜¯é‚£ä¸ªåˆ¶å®šåœºæ™¯ã€æŒæ¡å®‰å…¨è¯ã€åŒæ—¶ä¹Ÿä¿æŠ¤å¯¹æ–¹çš„äººã€‚çœŸæ­£çš„ Dom ä¸æ˜¯è›®åŠ›ï¼Œè€Œæ˜¯è®©å¯¹æ–¹å¿ƒç”˜æƒ…æ„¿åœ°æŠŠæ§åˆ¶æƒäº¤ç»™ä½ ã€‚';
            } else if (domRatio >= 0.52) {  // ä»0.55é™ä½åˆ°0.52
                bdsmRole = 'å Dom';
                bdsmRoleDesc = 'ä½ åå‘ä¸»å¯¼ï¼Œä½†æœ‰ä¸€å®šçš„çµæ´»æ€§ã€‚åœ¨ä¿¡ä»»çš„å…³ç³»ä¸­ä½ ä¼šè‡ªç„¶å±•ç°æ”¯é…æ¬²ï¼Œä½†ä¸ä¼šå¼ºè¿«å¯¹æ–¹æ¥å—ä½ çš„èŠ‚å¥ã€‚ä½ äº«å—ä¸»å¯¼çš„æ„Ÿè§‰ï¼Œä½†ä¹Ÿèƒ½æ¬£èµå¯¹æ–¹å¶å°”çš„åæŠ—æˆ–ä¸»åŠ¨â€”â€”é‚£ç§æ‹‰é”¯æ„Ÿåè€Œè®©ä½ æ›´å…´å¥‹ã€‚ä½ ä¸æ˜¯é‚£ç§éœ€è¦å®Œå…¨æŒæ§ä¸€åˆ‡çš„äººï¼Œæ›´äº«å—çš„æ˜¯åŒæ–¹åœ¨åŠ¨æ€ä¸­æ‰¾åˆ°å¹³è¡¡çš„è¿‡ç¨‹ã€‚';
            } else if (domRatio <= 0.35) {  // ä»0.3æé«˜åˆ°0.35
                bdsmRole = 'Sub é¡ºä»';
                bdsmRoleDesc = 'ä½ æœ‰å¤©ç”Ÿçš„é¡ºä»å€¾å‘ï¼Œäº«å—è¢«æŒæ§ã€è¢«å¼•å¯¼ã€è¢«ç…§é¡¾çš„æ„Ÿè§‰ã€‚æŠŠæ§åˆ¶æƒäº¤ç»™ä¸€ä¸ªä½ ä¿¡ä»»çš„äººï¼Œå¯¹ä½ æ¥è¯´æ˜¯ä¸€ç§æ·±å±‚çš„æ”¾æ¾å’Œè§£è„±â€”â€”ä¸éœ€è¦åšå†³å®šï¼Œåªéœ€è¦æ„Ÿå—ã€‚ä½ å¯¹å®‰å…¨æ„Ÿçš„éœ€æ±‚å¾ˆé«˜ï¼Œåªæœ‰åœ¨å®Œå…¨ä¿¡ä»»å¯¹æ–¹çš„å‰æä¸‹æ‰èƒ½çœŸæ­£æ”¾å¼€ã€‚è¢«ä¿æŠ¤ã€è¢«æ”¯é…ã€ç”šè‡³è¢«è½»å¾®æƒ©ç½šï¼Œåœ¨å®‰å…¨çš„æ¡†æ¶å†…è¿™äº›éƒ½èƒ½ç»™ä½ å¸¦æ¥å¼ºçƒˆçš„æ»¡è¶³æ„Ÿã€‚Sub ä¸æ˜¯è½¯å¼±ï¼Œè€Œæ˜¯éœ€è¦æå¤§çš„å‹‡æ°”æ‰èƒ½åšåˆ°çš„ä¿¡ä»»ã€‚';
            } else if (domRatio <= 0.48) {  // ä»0.45æé«˜åˆ°0.48
                bdsmRole = 'å Sub';
                bdsmRoleDesc = 'ä½ åå‘é¡ºä»ï¼Œå–œæ¬¢è¢«ä¸»å¯¼ï¼Œä½†ä¿æœ‰è‡ªå·±çš„åº•çº¿å’ŒèŠ‚å¥ã€‚ä½ ä¸ä¼šæ— æ¡ä»¶æœä»ï¼Œè€Œæ˜¯åœ¨è‡ªå·±è®¾å®šçš„è¾¹ç•Œå†…äº«å—è¢«å¼•å¯¼çš„æ„Ÿè§‰ã€‚å¯¹æ–¹éœ€è¦èµ¢å¾—ä½ çš„ä¿¡ä»»æ‰èƒ½è®©ä½ çœŸæ­£æ”¾å¼€ï¼Œå¼ºè¿«æˆ–è¶Šç•Œä¼šè®©ä½ ç«‹åˆ»å…³é—­ã€‚ä½ äº«å—é‚£ç§"è¢«çœ‹è§ã€è¢«ç…§é¡¾ã€è¢«æŒæ§"çš„æ„Ÿè§‰ï¼Œä½†å‰ææ˜¯å¯¹æ–¹è¶³å¤Ÿå°Šé‡ä½ ã€‚';
            } else {
                bdsmRole = 'Switch';
                bdsmRoleDesc = 'ä½ æ˜¯çœŸæ­£çš„ Switchï¼Œä¸»è¢«åŠ¨çš†å¯ï¼Œæ ¹æ®å¯¹è±¡å’Œæƒ…å¢ƒè‡ªç”±åˆ‡æ¢ã€‚æœ‰æ—¶å€™ä½ æƒ³ä¸»å¯¼ä¸€åˆ‡ï¼Œæœ‰æ—¶å€™ä½ æƒ³æŠŠæ§åˆ¶æƒå®Œå…¨äº¤å‡ºå»â€”â€”è¿™ä¸¤ç§çŠ¶æ€ä½ éƒ½èƒ½äº«å—ï¼Œè€Œä¸”åˆ‡æ¢èµ·æ¥å¾ˆè‡ªç„¶ã€‚è¿™ç§çµæ´»æ€§è®©ä½ èƒ½å’Œä¸åŒç±»å‹çš„äººå»ºç«‹æ·±åº¦çš„ BDSM å…³ç³»ï¼Œä½†ä¹Ÿæ„å‘³ç€ä½ éœ€è¦ä¸€ä¸ªèƒ½è¯»æ‡‚ä½ å½“ä¸‹çŠ¶æ€çš„ä¼´ä¾£ã€‚Switch å¾€å¾€æ˜¯æœ€éš¾æ‰¾åˆ°å®Œç¾åŒ¹é…çš„ç±»å‹ï¼Œå› ä¸ºä½ çš„éœ€æ±‚æœ¬èº«å°±æ˜¯å¤šå˜çš„ã€‚';
            }

            // æ†ç»‘/æŸç¼šå€¾å‘
            const bondageScore =
                (hasStar(ming, 'ä¸ƒæ€') ? 2 : 0) +
                (hasStar(ming, 'ç ´å†›') ? 2 : 0) +
                (hasStar(ziNv, 'ä¸ƒæ€') ? 3 : 0) +        // å­å¥³å®«ä¸ƒæ€ï¼šå–œæ¬¢è¢«æŸç¼š
                (hasStar(ziNv, 'å»‰è´') ? 2 : 0) +
                (hasStar(jiE, 'å»‰è´') ? 3 : 0) +         // ç–¾å„å®«å»‰è´ï¼šèº«ä½“å±‚é¢çš„æŸç¼šæ„Ÿ
                (hasStar(jiE, 'å¤©ç›¸') ? 2 : 0) +         // å¤©ç›¸ï¼šå–œæ¬¢è¢«æŸç¼š
                (hasStar(fuDe, 'è´ªç‹¼') ? 1 : 0) +
                (hasStar(ming, 'å¤©ç›¸') ? 2 : 0) +
                (hasStar(ziNv, 'å¤ªé˜´') ? 1 : 0) +
                (hasQuan ? 1 : 0);
            const bondageTend = bondageScore >= 5 ? 'é«˜' : bondageScore >= 3 ? 'ä¸­' : 'ä½';

            // æ–½è™/å—è™å€¾å‘ï¼ˆSMï¼‰
            const sadistScore =
                (hasStar(ming, 'ä¸ƒæ€') ? 3 : 0) +
                (hasStar(ming, 'å»‰è´') ? 2 : 0) +
                (hasStar(jiE, 'æ­¦æ›²') ? 1 : 0) +
                (hasQuan && !hasSihua(ming, 'åŒ–å¿Œ') ? 1 : 0);
            const masochScore =
                (hasStar(ming, 'å¤©ç›¸') ? 2 : 0) +
                (hasStar(ming, 'å¤ªé˜´') ? 1 : 0) +
                (hasStar(ziNv, 'ä¸ƒæ€') ? 3 : 0) +        // å­å¥³å®«ä¸ƒæ€ï¼šå—è™å€¾å‘
                (hasStar(ziNv, 'å»‰è´') ? 2 : 0) +        // å­å¥³å®«å»‰è´ï¼šå–œæ¬¢æ¿€çƒˆåˆºæ¿€
                (hasStar(ziNv, 'å¤©åŒ') ? 1 : 0) +
                (hasStar(jiE, 'å»‰è´') ? 3 : 0) +         // ç–¾å„å®«å»‰è´ï¼šèº«ä½“æ‰¿å—ç—›æ„Ÿ
                (hasStar(jiE, 'å¤©ç›¸') ? 2 : 0) +         // ç–¾å„å®«å¤©ç›¸ï¼šèº«ä½“æ•æ„Ÿ
                (hasSihua(ming, 'åŒ–å¿Œ') ? 2 : 0) +
                (hasSihua(jiE, 'åŒ–å¿Œ') ? 1 : 0);
            let smTend;
            if (sadistScore >= 4) smTend = 'æ–½è™å€¾å‘æ˜æ˜¾';
            else if (masochScore >= 4) smTend = 'å—è™å€¾å‘æ˜æ˜¾';      // é™ä½é˜ˆå€¼ä»3åˆ°4
            else if (sadistScore >= 2 && masochScore >= 2) smTend = 'æ–½å—è™çš†æœ‰å…´è¶£';
            else smTend = 'å¯¹ SM å…´è¶£ä¸€èˆ¬';

            // è§’è‰²æ‰®æ¼”å€¾å‘
            const roleplayScore =
                (hasStar(fuDe, 'è´ªç‹¼') ? 3 : 0) +
                (hasStar(ming, 'å¤©æœº') ? 2 : 0) +
                (hasStar(fuDe, 'å¤©æœº') ? 3 : 0) +        // ç¦å¾·å®«å¤©æœºï¼šå¿ƒç†æ¸¸æˆ
                (hasStar(ziNv, 'å¤©æœº') ? 2 : 0) +
                (hasStar(ming, 'ç ´å†›') ? 1 : 0) +
                (hasStar(ziNv, 'ç ´å†›') ? 1 : 0) +
                (hasStar(fuDe, 'å»‰è´') ? 1 : 0);
            const roleplayTend = roleplayScore >= 4 ? 'é«˜' : roleplayScore >= 2 ? 'ä¸­' : 'ä½';

            // å±•ç¤º/è¢«çœ‹å€¾å‘ï¼ˆExhibitionism/Voyeurismï¼‰
            const exhibScore =
                (hasStar(ming, 'å¤ªé˜³') && !hasSihua(ming, 'åŒ–å¿Œ') ? 3 : 0) +
                (hasStar(ming, 'è´ªç‹¼') ? 2 : 0) +
                (hasStar(fuDe, 'å¤ªé˜³') ? 1 : 0) +
                (hasStar(ming, 'å»‰è´') ? 1 : 0) +
                (hasStar(ziNv, 'å»‰è´') ? 2 : 0) +        // å­å¥³å®«å»‰è´ï¼šå±•ç¤ºæ¬²
                (hasStar(jiE, 'å»‰è´') ? 2 : 0);          // ç–¾å„å®«å»‰è´ï¼šèº«ä½“å±•ç¤º
            const voyeurScore =
                (hasStar(fuDe, 'å¤©æœº') ? 3 : 0) +        // ç¦å¾·å®«å¤©æœºï¼šè§‚å¯Ÿæ¬²
                (hasStar(ming, 'å¤©æœº') ? 1 : 0) +
                (hasStar(ziNv, 'å¤©æœº') ? 2 : 0) +
                (hasStar(fuDe, 'å¤ªé˜´') ? 2 : 0);
            let exhibTend;
            if (exhibScore >= 3) exhibTend = 'å–œæ¬¢è¢«çœ‹/å±•ç¤º';        // é™ä½é˜ˆå€¼ä»4åˆ°3
            else if (voyeurScore >= 3) exhibTend = 'åå¥½è§‚å¯Ÿ/çª¥è§†';
            else exhibTend = 'åå¥½ç§å¯†ç©ºé—´';

            // è¯­è¨€/ç²¾ç¥åˆºæ¿€å€¾å‘
            const verbalScore =
                (hasStar(ming, 'å·¨é—¨') ? 3 : 0) +
                (hasStar(ziNv, 'å·¨é—¨') ? 2 : 0) +
                (hasStar(fuDe, 'å·¨é—¨') ? 2 : 0) +
                (hasStar(fuDe, 'å¤©æœº') ? 2 : 0) +        // ç¦å¾·å®«å¤©æœºï¼šè¯­è¨€æ¸¸æˆ
                (hasStar(ming, 'å¤©æœº') ? 1 : 0) +
                (hasStar(jiE, 'æ–‡æ˜Œ') ? 2 : 0) +         // ç–¾å„å®«æ–‡æ˜Œï¼šè¯­è¨€åˆºæ¿€
                (hasStar(jiE, 'æ–‡æ›²') ? 2 : 0) +
                (hasStar(ming, 'æ–‡æ˜Œ') ? 1 : 0) +
                (hasStar(ming, 'æ–‡æ›²') ? 1 : 0) +
                (hasStar(fuDe, 'å¤©æ¢') ? 1 : 0);
            const verbalTend = verbalScore >= 4 ? 'é«˜â€”â€”è¯­è¨€å’Œç²¾ç¥åˆºæ¿€å¯¹ä½ æä¸ºé‡è¦' :
                               verbalScore >= 2 ? 'ä¸­â€”â€”é€‚å½“çš„è¯­è¨€äº’åŠ¨èƒ½å¢å¼ºä½“éªŒ' : 'ä½â€”â€”æ›´æ³¨é‡è‚¢ä½“æ„Ÿå—';

            // â”€â”€ Kçº§åˆ†ç±»ç³»ç»Ÿ (Kinsey-inspired BDSM Scale) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
            // è®¡ç®—ç»¼åˆå¼ºåº¦åˆ†æ•°
            let kScore = 0;
            kScore += bondageScore * 1.8;
            kScore += (sadistScore + masochScore) * 1.5;
            kScore += roleplayScore * 1.2;
            kScore += verbalScore * 1.0;
            kScore += (exhibScore + voyeurScore) * 0.8;
            if (domScore > subScore) kScore += (domScore - subScore) * 0.8;
            else kScore += (subScore - domScore) * 0.8;
            // åŸºç¡€åŠ åˆ†ï¼Œè®©æ¯ä¸ªäººéƒ½æœ‰ä¸€å®šçš„Kçº§
            kScore += 5;

            let kLevel, kLevelDesc, kLevelColor;
            if (kScore >= 28) {
                kLevel = 'K9'; kLevelColor = '#DAA520';
                kLevelDesc = 'æé‡åº¦ BDSM å€¾å‘ã€‚ä½ çš„æ€§åå¥½æ·±åº¦æ¶‰åŠæƒåŠ›äº¤æ¢ã€å¼ºçƒˆçš„èº«ä½“åˆºæ¿€å’Œå¤æ‚çš„å¿ƒç†åŠ¨æ€ã€‚ä½ å¯èƒ½å¯¹ TPEï¼ˆå…¨æƒåŠ›äº¤æ¢ï¼‰ã€24/7 ä¸»ä»å…³ç³»ã€é«˜å¼ºåº¦ SMã€æé™æŸç¼šç­‰æœ‰å¼ºçƒˆå…´è¶£ã€‚è¿™ä¸ªçº§åˆ«éœ€è¦æé«˜çš„ä¿¡ä»»ã€ä¸°å¯Œçš„ç»éªŒå’Œä¸¥æ ¼çš„å®‰å…¨æªæ–½ã€‚å»ºè®®æ·±å…¥å­¦ä¹  SSCï¼ˆå®‰å…¨ã€ç†æ™ºã€çŸ¥æƒ…åŒæ„ï¼‰å’Œ RACKï¼ˆé£é™©æ„è¯†çš„çŸ¥æƒ…åŒæ„ï¼‰åŸåˆ™ã€‚';
            } else if (kScore >= 24) {
                kLevel = 'K8'; kLevelColor = '#D4AF37';
                kLevelDesc = 'é‡åº¦ BDSM å€¾å‘ã€‚ä½ å¯¹ BDSM çš„å…´è¶£å·²ç»è¶…è¶Šäº†å¶å°”å°è¯•ï¼Œå¯èƒ½å¸Œæœ›å°†å…¶èå…¥æ—¥å¸¸ç”Ÿæ´»ã€‚å¯¹é«˜å¼ºåº¦çš„æŸç¼šã€SMã€æƒåŠ›äº¤æ¢æœ‰æ˜ç¡®éœ€æ±‚ã€‚å¯èƒ½å¯¹ CNCï¼ˆåå•†ä¸€è‡´çš„éåŒæ„ï¼‰ã€Primal Playï¼ˆåŸå§‹æ¸¸æˆï¼‰ã€ä¸¥æ ¼çš„çºªå¾‹ä¸æƒ©ç½šæœ‰å…´è¶£ã€‚éœ€è¦å¯»æ‰¾ç»éªŒä¸°å¯Œã€ä»·å€¼è§‚å¥‘åˆçš„ä¼´ä¾£ã€‚';
            } else if (kScore >= 20) {
                kLevel = 'K7'; kLevelColor = '#DDB76E';
                kLevelDesc = 'ä¸­é‡åº¦ BDSM å€¾å‘ã€‚BDSM æ˜¯ä½ æ€§ç”Ÿæ´»çš„é‡è¦ç»„æˆéƒ¨åˆ†ï¼Œä¸åªæ˜¯è°ƒå‰‚ã€‚ä½ å¯èƒ½å¯¹ç»³ç¼šè‰ºæœ¯ï¼ˆShibariï¼‰ã€é­æ‰“ã€ç”µå‡»ã€é’ˆåˆºã€ç¾è¾±æ¸¸æˆç­‰æœ‰æ˜ç¡®åå¥½ã€‚å¼€å§‹æ¢ç´¢æ›´æ·±å±‚çš„å¿ƒç†æ”¯é…ä¸è‡£æœå…³ç³»ã€‚å»ºè®®åŠ å…¥æœ¬åœ° BDSM ç¤¾ç¾¤ï¼Œå‚åŠ å·¥ä½œåŠå­¦ä¹ æŠ€æœ¯å’Œå®‰å…¨çŸ¥è¯†ã€‚';
            } else if (kScore >= 16) {
                kLevel = 'K6'; kLevelColor = '#E6C285';
                kLevelDesc = 'ä¸­åº¦ BDSM å€¾å‘ã€‚ä½ å¯¹ BDSM æœ‰ç¨³å®šçš„å…´è¶£ï¼Œæ„¿æ„å®šæœŸå®è·µã€‚å¯èƒ½å¯¹ä¸­ç­‰å¼ºåº¦çš„æŸç¼šã€é­æ‰“ã€æ»´èœ¡ã€è§’è‰²æ‰®æ¼”ã€å® ç‰©æ¸¸æˆï¼ˆPet Playï¼‰æœ‰å…´è¶£ã€‚å¼€å§‹å»ºç«‹è‡ªå·±çš„åå¥½ä½“ç³»ï¼ŒçŸ¥é“ä»€ä¹ˆèƒ½æ¿€å‘ä½ ï¼Œä»€ä¹ˆæ˜¯ç¡¬é™åˆ¶ï¼ˆHard Limitï¼‰ã€‚';
            } else if (kScore >= 12) {
                kLevel = 'K5'; kLevelColor = '#EFCD9C';
                kLevelDesc = 'ä¸­è½»åº¦ BDSM å€¾å‘ã€‚ä½ å¯¹ BDSM æœ‰æ˜ç¡®çš„å¥½å¥‡å’Œå…´è¶£ï¼Œæ„¿æ„ä¸»åŠ¨æ¢ç´¢ã€‚å¯èƒ½å¯¹è½»åº¦æŸç¼šã€è’™çœ¼ã€è½»åº¦ç–¼ç—›åˆºæ¿€ã€ä¸»ä»è§’è‰²æ‰®æ¼”æ„Ÿå…´è¶£ã€‚è¿™æ˜¯ä¸€ä¸ªæ¢ç´¢æœŸï¼Œå»ºè®®å¤šæ²Ÿé€šã€å¤šå°è¯•ï¼Œæ‰¾åˆ°è‡ªå·±çœŸæ­£å–œæ¬¢çš„æ–¹å‘ã€‚';
            } else if (kScore >= 8) {
                kLevel = 'K4'; kLevelColor = '#F8D8B3';
                kLevelDesc = 'è½»åº¦ BDSM å€¾å‘ã€‚ä½ å¯¹ BDSM å…ƒç´ æœ‰ä¸€å®šå…´è¶£ï¼Œä½†ä¸æ˜¯å¿…éœ€å“ã€‚å¯èƒ½å¶å°”å–œæ¬¢å°è¯•æ‰‹é“ã€ä¸å·¾æŸç¼šã€è½»å¾®çš„æƒåŠ›æ¸¸æˆã€‚è¿™äº›å…ƒç´ èƒ½å¢åŠ æ–°é²œæ„Ÿï¼Œä½†ä¼ ç»Ÿæ–¹å¼ä¹Ÿèƒ½è®©ä½ æ»¡è¶³ã€‚';
            } else if (kScore >= 7) {
                kLevel = 'K3'; kLevelColor = '#FFE3CA';
                kLevelDesc = 'å¾®åº¦ BDSM å€¾å‘ã€‚ä½ å¯¹ BDSM æœ‰ä¸€ç‚¹ç‚¹å¥½å¥‡ï¼Œä½†ä¸ç¡®å®šæ˜¯å¦çœŸçš„å–œæ¬¢ã€‚å¯èƒ½åœ¨ç‰¹å®šæƒ…å¢ƒä¸‹æ„¿æ„å°è¯•éå¸¸è½»åº¦çš„å…ƒç´ ï¼Œæ¯”å¦‚è¢«è’™çœ¼ã€è½»å¾®çš„è§’è‰²æ‰®æ¼”ã€‚éœ€è¦è¶³å¤Ÿçš„å®‰å…¨æ„Ÿå’Œä¿¡ä»»æ‰ä¼šå°è¯•ã€‚';
            } else if (kScore >= 4) {
                kLevel = 'K2'; kLevelColor = '#FFEEE1';
                kLevelDesc = 'æè½»åº¦å€¾å‘ã€‚ä½ å¯¹ BDSM åŸºæœ¬æ²¡æœ‰å…´è¶£ï¼Œåå¥½ä¼ ç»Ÿçš„äº²å¯†æ–¹å¼ã€‚å¯èƒ½å¶å°”æ¥å—éå¸¸æ¸©å’Œçš„å˜åŒ–ï¼ˆå¦‚è½»å¾®çš„ä¸»å¯¼/é…åˆï¼‰ï¼Œä½†ä»»ä½•æ˜æ˜¾çš„æƒåŠ›å·®å¼‚æˆ–ç–¼ç—›åˆºæ¿€éƒ½ä¼šè®©ä½ ä¸é€‚ã€‚';
            } else {
                kLevel = 'K1'; kLevelColor = '#FFF8F0';
                kLevelDesc = 'æ—  BDSM å€¾å‘ã€‚ä½ å®Œå…¨ä¸éœ€è¦ BDSM å…ƒç´ ï¼Œåå¥½å¹³ç­‰ã€æ¸©å’Œã€ä¼ ç»Ÿçš„äº²å¯†å…³ç³»ã€‚ä»»ä½•å½¢å¼çš„æŸç¼šã€ç–¼ç—›æˆ–æƒåŠ›æ¸¸æˆéƒ½ä¼šè®©ä½ æ„Ÿåˆ°ä¸èˆ’æœã€‚ä½ æ›´çœ‹é‡æƒ…æ„Ÿè¿æ¥å’Œèˆ’é€‚çš„ä½“éªŒã€‚';
            }

            // â”€â”€ æ‰©å±•å°ä¼—ç™–å¥½åˆ†ç±» (20+ ç§è¯¦ç»†åˆ†ç±») â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
            const detailedFetishes = [];

            // 1. ç»³ç¼šè‰ºæœ¯ Shibari/Kinbaku
            if (bondageScore >= 1 || hasStar(fuDe, 'å¤ªé˜´') || hasStar(ming, 'å¤©æœº') || hasStar(ziNv, 'ä¸ƒæ€') || hasStar(ming, 'å¤ªé˜´') || hasStar(ziNv, 'å¤©æœº') || hasStar(jiE, 'å¤ªé˜´') || hasStar(fuDe, 'å¤©æœº')) {
                detailedFetishes.push({
                    name: 'ç»³ç¼šè‰ºæœ¯ Shibari',
                    intensity: 'ä¸­-é«˜',
                    desc: 'å¯¹æ—¥å¼ç»³ç¼šæœ‰ç‰¹åˆ«çš„ç¾å­¦è¿½æ±‚ã€‚ä¸åªæ˜¯æŸç¼šæœ¬èº«ï¼Œæ›´æ˜¯ç»³ç´¢åœ¨èº«ä½“ä¸Šå½¢æˆçš„å›¾æ¡ˆã€å‹è¿«æ„Ÿã€ä»¥åŠæ•´ä¸ªè¿‡ç¨‹çš„ä»ªå¼æ„Ÿã€‚ä½ å¯èƒ½å¯¹éº»ç»³çš„è´¨æ„Ÿã€ç»³ç»“çš„å¯¹ç§°æ€§ã€èº«ä½“è¢«ç»³ç´¢å‹’å‡ºçš„ç—•è¿¹æœ‰ç‰¹åˆ«çš„è¿·æ‹ã€‚',
                    tags: ['è§†è§‰ç¾å­¦', 'èº«ä½“è‰ºæœ¯', 'ä¿¡ä»»å»ºç«‹']
                });
            }

            // 2. å® ç‰©æ¸¸æˆ Pet Play
            if (hasStar(ziNv, 'å¤©åŒ') || hasStar(ming, 'å¤©ç›¸') || hasStar(ming, 'å¤©åŒ') || subScore >= 1 || hasStar(fuDe, 'å¤©åŒ') || hasStar(ziNv, 'å¤©ç›¸') || hasStar(fuDe, 'å¤©ç›¸')) {
                detailedFetishes.push({
                    name: 'å® ç‰©æ¸¸æˆ Pet Play',
                    intensity: 'è½»-ä¸­',
                    desc: 'äº«å—æ‰®æ¼”å® ç‰©ï¼ˆå°çŒ«ã€å°ç‹—ã€å°å…”ç­‰ï¼‰çš„è§’è‰²ï¼Œè¢«ä¸»äººç…§é¡¾ã€è®­ç»ƒã€å¥–åŠ±æˆ–æƒ©ç½šã€‚è¿™ç§è§’è‰²è®©ä½ å¯ä»¥æ”¾ä¸‹äººç±»çš„å¤æ‚æ€§ï¼Œå›åˆ°æ›´çº¯ç²¹çš„çŠ¶æ€ã€‚å¯èƒ½å¯¹é¡¹åœˆã€ç‰µå¼•ç»³ã€å® ç‰©ç¢—ã€è€³æœµå°¾å·´ç­‰é“å…·æœ‰å…´è¶£ã€‚',
                    tags: ['è§’è‰²æ‰®æ¼”', 'ç…§é¡¾å…³ç³»', 'æ”¾æ¾å¿ƒæ™º']
                });
            }

            // 3. ç¾è¾±æ¸¸æˆ Humiliation
            if (hasStar(ming, 'å·¨é—¨') || hasStar(ziNv, 'å·¨é—¨') || masochScore >= 1 || sadistScore >= 1 || hasStar(fuDe, 'å·¨é—¨') || hasStar(jiE, 'å·¨é—¨')) {
                detailedFetishes.push({
                    name: 'ç¾è¾±æ¸¸æˆ Humiliation',
                    intensity: 'ä¸­-é«˜',
                    desc: 'å¯¹è¯­è¨€æˆ–è¡Œä¸ºä¸Šçš„ç¾è¾±æœ‰å¼ºçƒˆååº”ã€‚å¯èƒ½æ˜¯äº«å—è¢«ç¾è¾±ï¼ˆè¨€è¯­è´¬ä½ã€å…¬å¼€å±•ç¤ºã€å¼ºåˆ¶è¡Œä¸ºï¼‰ï¼Œæˆ–äº«å—ç¾è¾±å¯¹æ–¹ã€‚è¿™æ˜¯ä¸€ç§æ·±å±‚çš„å¿ƒç†æ¸¸æˆï¼Œéœ€è¦æé«˜çš„ä¿¡ä»»å’Œæ˜ç¡®çš„è¾¹ç•Œã€‚ç¾è¾±çš„å¿«æ„Ÿæ¥è‡ªäºæ‰“ç ´ç¤¾ä¼šè§„èŒƒå’Œè‡ªæˆ‘å½¢è±¡ã€‚',
                    tags: ['å¿ƒç†åˆºæ¿€', 'æƒåŠ›åŠ¨æ€', 'è¾¹ç•Œæ¢ç´¢']
                });
            }

            // 4. æ„Ÿå®˜å‰¥å¤º Sensory Deprivation
            if (hasStar(fuDe, 'å¤ªé˜´') || hasStar(ming, 'å¤ªé˜´') || bondageScore >= 1 || hasStar(ziNv, 'å¤ªé˜´') || hasStar(ming, 'å¤©æœº') || hasStar(jiE, 'å¤ªé˜´') || hasStar(fuDe, 'å¤©æœº')) {
                detailedFetishes.push({
                    name: 'æ„Ÿå®˜å‰¥å¤º Sensory Deprivation',
                    intensity: 'ä¸­',
                    desc: 'é€šè¿‡è’™çœ¼ã€è€³å¡ã€éš”éŸ³å¤´å¥—ç­‰æ–¹å¼å‰¥å¤ºéƒ¨åˆ†æ„Ÿå®˜ï¼Œè®©å…¶ä»–æ„Ÿå®˜è¢«æ”¾å¤§ã€‚è§¦è§‰ã€å¬è§‰ã€ç”šè‡³æ—¶é—´æ„Ÿéƒ½ä¼šå˜å¾—å¼‚å¸¸æ•é”ã€‚è¿™ç§ä¸ç¡®å®šæ„Ÿå’Œå¯¹å¯¹æ–¹çš„å®Œå…¨ä¾èµ–èƒ½å¸¦æ¥å¼ºçƒˆçš„å¿ƒç†ä½“éªŒã€‚',
                    tags: ['æ„Ÿå®˜å¼ºåŒ–', 'ä¿¡ä»»ä¾èµ–', 'å¿ƒç†æ²‰æµ¸']
                });
            }

            // 5. å†°ç«æ¸¸æˆ Temperature Play
            if (hasStar(fuDe, 'è´ªç‹¼') || hasStar(ziNv, 'è´ªç‹¼') || hasStar(ming, 'è´ªç‹¼') || hasStar(jiE, 'è´ªç‹¼') || hasStar(ming, 'å»‰è´') || hasStar(ziNv, 'å»‰è´')) {
                detailedFetishes.push({
                    name: 'å†°ç«æ¸¸æˆ Temperature Play',
                    intensity: 'è½»-ä¸­',
                    desc: 'ä½¿ç”¨å†°å—ã€çƒ­èœ¡ã€æ¸©æ°´ã€å†·çƒ­äº¤æ›¿åˆºæ¿€çš®è‚¤ã€‚æ¸©åº¦çš„å˜åŒ–èƒ½å¸¦æ¥å¼ºçƒˆçš„æ„Ÿå®˜å†²å‡»ï¼Œå†°çš„åˆºç—›å’Œèœ¡çš„ç¼çƒ­å½¢æˆé²œæ˜å¯¹æ¯”ã€‚è¿™æ˜¯ä¸€ç§ç›¸å¯¹å®‰å…¨ä½†æ•ˆæœæ˜æ˜¾çš„æ„Ÿå®˜æ¸¸æˆã€‚',
                    tags: ['æ„Ÿå®˜åˆºæ¿€', 'æ¸©åº¦å¯¹æ¯”', 'å®‰å…¨æ¢ç´¢']
                });
            }

            // 6. ç”µå‡»æ¸¸æˆ Electrostimulation
            if (hasStar(ming, 'å»‰è´') || hasStar(ziNv, 'å»‰è´') || hasStar(jiE, 'å»‰è´') || hasStar(fuDe, 'å»‰è´') || kScore >= 7) {
                detailedFetishes.push({
                    name: 'ç”µå‡»æ¸¸æˆ E-stim',
                    intensity: 'é«˜',
                    desc: 'ä½¿ç”¨ç”µå‡»æ£’ã€ç”µå‡»é¡¹åœˆã€TENS è®¾å¤‡ç­‰äº§ç”Ÿç”µæµåˆºæ¿€ã€‚ä»è½»å¾®çš„åˆºç—›åˆ°å¼ºçƒˆçš„è‚Œè‚‰æ”¶ç¼©ï¼Œç”µå‡»èƒ½å¸¦æ¥ç‹¬ç‰¹çš„æ„Ÿå—ã€‚è¿™æ˜¯ä¸€ç§é«˜é£é™©æ¸¸æˆï¼Œå¿…é¡»ä½¿ç”¨ä¸“ä¸šè®¾å¤‡ï¼Œé¿å¼€å¿ƒè„å’Œå¤´éƒ¨åŒºåŸŸã€‚',
                    tags: ['å¼ºçƒˆåˆºæ¿€', 'æŠ€æœ¯è¦æ±‚', 'é£é™©ç®¡ç†']
                });
            }

            // 7. çª’æ¯æ¸¸æˆ Breath Play
            if ((hasStar(ming, 'å»‰è´') || hasStar(jiE, 'å»‰è´') || hasStar(ziNv, 'å»‰è´') || hasStar(fuDe, 'å»‰è´')) && kScore >= 8) {
                detailedFetishes.push({
                    name: 'çª’æ¯æ¸¸æˆ Breath Play',
                    intensity: 'æé«˜',
                    desc: 'é€šè¿‡æ§åˆ¶å‘¼å¸ï¼ˆæ‰‹æã€ç»³ç´¢ã€é¢ç½©ç­‰ï¼‰äº§ç”Ÿç¼ºæ°§æ„Ÿã€‚è¿™æ˜¯ BDSM ä¸­æœ€å±é™©çš„æ¸¸æˆä¹‹ä¸€ï¼Œå¯èƒ½å¯¼è‡´ä¸¥é‡åæœç”šè‡³æ­»äº¡ã€‚å¦‚æœä¸€å®šè¦å°è¯•ï¼Œå¿…é¡»å……åˆ†å­¦ä¹ å®‰å…¨çŸ¥è¯†ï¼Œæ°¸è¿œä¸è¦å•ç‹¬è¿›è¡Œï¼Œè®¾ç½®æ˜ç¡®çš„å®‰å…¨ä¿¡å·ã€‚',
                    tags: ['æé™ä½“éªŒ', 'é«˜åº¦å±é™©', 'ä¸¥æ ¼å®‰å…¨']
                });
            }

            // 8. é’ˆåˆºæ¸¸æˆ Needle Play
            if ((hasStar(ming, 'ä¸ƒæ€') || hasStar(ziNv, 'ä¸ƒæ€') || hasStar(fuDe, 'ä¸ƒæ€')) && kScore >= 8) {
                detailedFetishes.push({
                    name: 'é’ˆåˆºæ¸¸æˆ Needle Play',
                    intensity: 'é«˜',
                    desc: 'ä½¿ç”¨æ— èŒé’ˆå¤´åˆºç©¿çš®è‚¤ï¼Œäº§ç”Ÿç–¼ç—›å’Œè§†è§‰åˆºæ¿€ã€‚è¿™æ˜¯ä¸€ç§æåº¦å°ä¼—çš„æ¸¸æˆï¼Œéœ€è¦åŒ»ç–—çº§åˆ«çš„å«ç”Ÿæ¡ä»¶å’Œä¸“ä¸šçŸ¥è¯†ã€‚é’ˆåˆºçš„ç–¼ç—›æ˜¯å°–é”è€ŒæŒç»­çš„ï¼Œä¸é­æ‰“å®Œå…¨ä¸åŒã€‚',
                    tags: ['æé™ç–¼ç—›', 'åŒ»ç–—çº§å«ç”Ÿ', 'ä¸“ä¸šæŠ€æœ¯']
                });
            }

            // 9. èœ¡çƒ›æ¸¸æˆ Wax Play
            if (hasStar(ziNv, 'å»‰è´') || hasStar(jiE, 'å»‰è´') || hasStar(ming, 'å»‰è´') || hasStar(fuDe, 'å»‰è´') || hasStar(fuDe, 'è´ªç‹¼')) {
                detailedFetishes.push({
                    name: 'èœ¡çƒ›æ¸¸æˆ Wax Play',
                    intensity: 'è½»-ä¸­',
                    desc: 'å°†èåŒ–çš„èœ¡æ²¹æ»´åœ¨çš®è‚¤ä¸Šï¼Œäº§ç”Ÿç¼çƒ­æ„Ÿå’Œè§†è§‰æ•ˆæœã€‚ä¸åŒèœ¡çƒ›æ¸©åº¦ä¸åŒï¼ˆå¤§è±†èœ¡æœ€ä½ï¼ŒçŸ³èœ¡æœ€é«˜ï¼‰ï¼Œå¯ä»¥æ ¹æ®æ‰¿å—åº¦é€‰æ‹©ã€‚èœ¡æ²¹å‡å›ºåå‰¥ç¦»çš„è¿‡ç¨‹ä¹Ÿæ˜¯ä¸€ç§ç‹¬ç‰¹ä½“éªŒã€‚',
                    tags: ['æ¸©åº¦åˆºæ¿€', 'è§†è§‰ç¾æ„Ÿ', 'å¯æ§å¼ºåº¦']
                });
            }

            // 10. é­æ‰“æ¸¸æˆ Impact Play
            if (sadistScore >= 1 || masochScore >= 1 || hasStar(ming, 'ä¸ƒæ€') || hasStar(ziNv, 'ä¸ƒæ€') || hasStar(ming, 'ç ´å†›') || hasStar(ziNv, 'ç ´å†›') || hasStar(fuDe, 'ä¸ƒæ€') || hasStar(jiE, 'ä¸ƒæ€')) {
                detailedFetishes.push({
                    name: 'é­æ‰“æ¸¸æˆ Impact Play',
                    intensity: 'ä¸­-é«˜',
                    desc: 'ä½¿ç”¨æ‰‹æŒã€é­å­ã€æ¡¨æ¿ã€è—¤æ¡ç­‰å‡»æ‰“èº«ä½“ã€‚ä»è½»æŸ”çš„æ‹æ‰“åˆ°ç•™ä¸‹ç—•è¿¹çš„é­æ‰“ï¼Œå¼ºåº¦å¯ä»¥çµæ´»è°ƒæ•´ã€‚ç–¼ç—›ä¼šé‡Šæ”¾å†…å•¡è‚½ï¼Œäº§ç”Ÿ"é£è¡Œæ„Ÿ"ï¼ˆSubspaceï¼‰ã€‚éœ€è¦å­¦ä¹ å®‰å…¨åŒºåŸŸï¼Œé¿å¼€è„Šæ¤ã€è‚¾è„ã€å…³èŠ‚ç­‰å±é™©éƒ¨ä½ã€‚',
                    tags: ['ç–¼ç—›åˆºæ¿€', 'å†…å•¡è‚½é‡Šæ”¾', 'æŠ€æœ¯å­¦ä¹ ']
                });
            }

            // 11. å°¿æ§æ¸¸æˆ Watersports
            if (hasStar(ming, 'ç ´å†›') || hasStar(ziNv, 'ç ´å†›') || hasStar(fuDe, 'ç ´å†›') || hasStar(jiE, 'ç ´å†›')) {
                detailedFetishes.push({
                    name: 'å°¿æ§æ¸¸æˆ Watersports',
                    intensity: 'ä¸­',
                    desc: 'æ¶‰åŠå°¿æ¶²çš„æ¸¸æˆï¼Œå¯èƒ½æ˜¯è¢«å°¿ã€å–å°¿ã€æ†‹å°¿æ§åˆ¶ç­‰ã€‚è¿™æ˜¯ä¸€ç§ç¦å¿Œæ„Ÿå¾ˆå¼ºçš„æ¸¸æˆï¼Œæ‰“ç ´äº†ç¤¾ä¼šå¯¹"å¹²å‡€"çš„å®šä¹‰ã€‚å¯¹ä¸€äº›äººæ¥è¯´ï¼Œè¿™ç§ç¾è¾±æ„Ÿå’Œè‡£æœæ„Ÿæ˜¯å¼ºçƒˆçš„å…´å¥‹ç‚¹ã€‚',
                    tags: ['ç¦å¿Œæ¢ç´¢', 'ç¾è¾±å…ƒç´ ', 'å«ç”Ÿæ³¨æ„']
                });
            }

            // 12. ç²ªä¾¿æ¸¸æˆ Scat Play
            if (hasStar(ming, 'ç ´å†›') && hasStar(ziNv, 'ç ´å†›') && kScore >= 10) {
                detailedFetishes.push({
                    name: 'ç²ªä¾¿æ¸¸æˆ Scat Play',
                    intensity: 'æé«˜',
                    desc: 'æ¶‰åŠç²ªä¾¿çš„æ¸¸æˆï¼Œæ˜¯æœ€æç«¯çš„ç¦å¿Œä¹‹ä¸€ã€‚è¿™ç§æ¸¸æˆæ‰“ç ´äº†å‡ ä¹æ‰€æœ‰ç¤¾ä¼šè§„èŒƒï¼Œåªæœ‰æå°‘æ•°äººèƒ½æ¥å—ã€‚å¦‚æœä½ å¯¹æ­¤æœ‰å…´è¶£ï¼ŒåŠ¡å¿…æ³¨æ„å«ç”Ÿå’Œå¥åº·é£é™©ã€‚',
                    tags: ['æé™ç¦å¿Œ', 'å¥åº·é£é™©', 'æåº¦å°ä¼—']
                });
            }

            // 13. å¹´é¾„æ¸¸æˆ Age Play
            if (hasStar(fuDe, 'å¤©åŒ') || hasStar(ming, 'å¤©åŒ') || hasStar(ziNv, 'å¤©åŒ') || hasStar(ming, 'å¤©ç›¸') || hasStar(ziNv, 'å¤©ç›¸') || hasStar(fuDe, 'å¤©ç›¸')) {
                detailedFetishes.push({
                    name: 'å¹´é¾„æ¸¸æˆ Age Play',
                    intensity: 'è½»-ä¸­',
                    desc: 'æ‰®æ¼”ä¸åŒå¹´é¾„çš„è§’è‰²ï¼Œé€šå¸¸æ˜¯æˆå¹´äººæ‰®æ¼”å„¿ç«¥ï¼ˆLittleï¼‰æˆ–ç…§é¡¾è€…ï¼ˆCaregiver/Daddy/Mommyï¼‰ã€‚è¿™ä¸æ¶‰åŠçœŸå®å„¿ç«¥ï¼Œè€Œæ˜¯æˆå¹´äººä¹‹é—´çš„è§’è‰²æ‰®æ¼”ã€‚Little å¯ä»¥ä½“éªŒè¢«ç…§é¡¾ã€è¢«ä¿æŠ¤çš„æ„Ÿè§‰ï¼Œæš‚æ—¶é€ƒç¦»æˆå¹´äººçš„è´£ä»»ã€‚',
                    tags: ['è§’è‰²æ‰®æ¼”', 'ç…§é¡¾å…³ç³»', 'å¿ƒç†é€€è¡Œ']
                });
            }

            // 14. åŒ»ç–—æ¸¸æˆ Medical Play
            if (hasStar(ming, 'å¤©æœº') || hasStar(fuDe, 'å¤©æœº') || hasStar(ziNv, 'å¤©æœº') || hasStar(jiE, 'å¤©æœº') || hasStar(ming, 'å¤©ç›¸')) {
                detailedFetishes.push({
                    name: 'åŒ»ç–—æ¸¸æˆ Medical Play',
                    intensity: 'ä¸­',
                    desc: 'æ‰®æ¼”åŒ»ç”Ÿ/æŠ¤å£«å’Œç—…äººï¼Œè¿›è¡Œ"æ£€æŸ¥"ã€"æ²»ç–—"ã€‚å¯èƒ½æ¶‰åŠåŒ»ç–—å™¨æ¢°ã€åˆ¶æœã€ä¸“ä¸šæœ¯è¯­ã€‚è¿™ç§æ¸¸æˆç»“åˆäº†æƒåŠ›å·®å¼‚ã€ç¾è€»æ„Ÿå’Œå¯¹èº«ä½“çš„æ¢ç´¢ã€‚',
                    tags: ['è§’è‰²æ‰®æ¼”', 'æƒåŠ›å·®å¼‚', 'èº«ä½“æ¢ç´¢']
                });
            }

            // 15. å¼ºåˆ¶é«˜æ½® Forced Orgasm
            if (hasStar(jiE, 'è´ªç‹¼') || hasStar(jiE, 'å»‰è´') || masochScore >= 1 || bondageScore >= 1 || hasStar(ziNv, 'è´ªç‹¼') || hasStar(ming, 'è´ªç‹¼')) {
                detailedFetishes.push({
                    name: 'å¼ºåˆ¶é«˜æ½® Forced Orgasm',
                    intensity: 'ä¸­-é«˜',
                    desc: 'è¢«æŸç¼šåï¼Œä½¿ç”¨éœ‡åŠ¨æ£’ç­‰å·¥å…·æŒç»­åˆºæ¿€ï¼Œç›´åˆ°å¤šæ¬¡é«˜æ½®ç”šè‡³è¿‡åº¦åˆºæ¿€ã€‚è¿™ç§"è¢«è¿«"çš„å¿«æ„Ÿå’Œå¤±æ§æ„Ÿæ˜¯å¼ºçƒˆçš„å¿ƒç†ä½“éªŒã€‚é«˜æ½®åçš„æ•æ„ŸæœŸç»§ç»­åˆºæ¿€ä¼šå¸¦æ¥ç—›è‹¦å’Œå¿«æ„Ÿçš„æ··åˆã€‚',
                    tags: ['å¼ºåˆ¶å¿«æ„Ÿ', 'å¤±æ§ä½“éªŒ', 'è€åŠ›æµ‹è¯•']
                });
            }

            // 16. é«˜æ½®æ§åˆ¶ Orgasm Control/Denial
            if (domScore >= 1 || subScore >= 1 || bondageScore >= 1) {
                detailedFetishes.push({
                    name: 'é«˜æ½®æ§åˆ¶ Orgasm Control',
                    intensity: 'ä¸­',
                    desc: 'ç”±ä¸»å¯¼æ–¹å†³å®šä½•æ—¶å¯ä»¥é«˜æ½®ï¼Œæˆ–é•¿æœŸç¦æ­¢é«˜æ½®ï¼ˆChastityï¼‰ã€‚è¿™æ˜¯ä¸€ç§æ·±å±‚çš„æƒåŠ›äº¤æ¢ï¼Œèº«ä½“çš„æœ€ç»ˆå¿«æ„Ÿè¢«ä»–äººæŒæ§ã€‚é•¿æœŸçš„é«˜æ½®æ‹’ç»ä¼šè®©æ¬²æœ›ç´¯ç§¯åˆ°æè‡´ï¼Œæœ€ç»ˆçš„é‡Šæ”¾ä¼šå¼‚å¸¸å¼ºçƒˆã€‚',
                    tags: ['æƒåŠ›äº¤æ¢', 'æ¬²æœ›ç´¯ç§¯', 'å¿ƒç†æ§åˆ¶']
                });
            }

            // 17. è´æ“å¸¦ Chastity Device
            if (subScore >= 2 || bondageScore >= 2) {
                detailedFetishes.push({
                    name: 'è´æ“å¸¦ Chastity',
                    intensity: 'ä¸­-é«˜',
                    desc: 'ä½©æˆ´è´æ“å¸¦/è´æ“é”ï¼Œç‰©ç†ä¸Šé˜»æ­¢æ€§è¡Œä¸ºå’Œè‡ªæ…°ã€‚é’¥åŒ™ç”±ä¸»å¯¼æ–¹ä¿ç®¡ï¼Œå¯èƒ½æ˜¯å‡ å°æ—¶ã€å‡ å¤©ç”šè‡³å‡ å‘¨ã€‚è¿™ç§æŒç»­çš„æŸç¼šæ„Ÿå’Œå¯¹å¯¹æ–¹çš„ä¾èµ–æ˜¯å¼ºçƒˆçš„å¿ƒç†ä½“éªŒã€‚',
                    tags: ['é•¿æœŸæŸç¼š', 'æƒåŠ›è±¡å¾', 'æŒç»­æé†’']
                });
            }

            // 18. å…¬å¼€ç¾è¾± Public Humiliation
            if (hasStar(ming, 'ç ´å†›') || exhibScore >= 1 || hasStar(ziNv, 'ç ´å†›') || hasStar(fuDe, 'ç ´å†›') || hasStar(ming, 'è´ªç‹¼') || hasStar(ziNv, 'è´ªç‹¼')) {
                detailedFetishes.push({
                    name: 'å…¬å¼€ç¾è¾± Public Humiliation',
                    intensity: 'é«˜',
                    desc: 'åœ¨å…¬å…±åœºæ‰€è¿›è¡Œç¾è¾±è¡Œä¸ºï¼ˆç©¿ç€æš´éœ²ã€ä½©æˆ´é¡¹åœˆã€æ‰§è¡Œå‘½ä»¤ç­‰ï¼‰ï¼Œæˆ–è€…æœ‰è¢«çœ‹åˆ°çš„é£é™©ã€‚è¿™ç§ç¦å¿Œæ„Ÿå’Œç¾è€»æ„Ÿæ˜¯å¼ºçƒˆçš„å…´å¥‹ç‚¹ã€‚åŠ¡å¿…æ³¨æ„æ³•å¾‹å’Œä»–äººæ„Ÿå—ï¼Œä¸è¦è®©æ— è¾œè·¯äººå·å…¥ã€‚',
                    tags: ['å…¬å…±åœºæ‰€', 'ç¾è€»åˆºæ¿€', 'æ³•å¾‹é£é™©']
                });
            }

            // 19. ç¾¤ä½“æ¸¸æˆ Group Play
            if (hasStar(fuDe, 'è´ªç‹¼') || hasStar(ming, 'è´ªç‹¼') || hasStar(ziNv, 'è´ªç‹¼') || hasStar(jiE, 'è´ªç‹¼') || hasStar(fuDe, 'å»‰è´')) {
                detailedFetishes.push({
                    name: 'ç¾¤ä½“æ¸¸æˆ Group Play',
                    intensity: 'ä¸­-é«˜',
                    desc: 'ä¸‰äººæˆ–å¤šäººå‚ä¸çš„ BDSM åœºæ™¯ã€‚å¯èƒ½æ˜¯å¤šä¸ª Dom å¯¹ä¸€ä¸ª Subï¼Œæˆ–ä¸€ä¸ª Dom å¯¹å¤šä¸ª Subï¼Œæˆ–æ›´å¤æ‚çš„ç»„åˆã€‚è¿™éœ€è¦æé«˜çš„æ²Ÿé€šèƒ½åŠ›å’Œè¾¹ç•Œç®¡ç†ï¼Œä½†èƒ½å¸¦æ¥ç‹¬ç‰¹çš„ä½“éªŒã€‚',
                    tags: ['å¤šäººå‚ä¸', 'å¤æ‚åŠ¨æ€', 'æ²Ÿé€šè¦æ±‚']
                });
            }

            // 20. åŸå§‹æ¸¸æˆ Primal Play
            if (hasStar(ming, 'ä¸ƒæ€') || hasStar(ming, 'ç ´å†›') || hasStar(ziNv, 'ä¸ƒæ€') || hasStar(ziNv, 'ç ´å†›') || hasStar(fuDe, 'ä¸ƒæ€') || hasStar(fuDe, 'ç ´å†›') || hasStar(jiE, 'ä¸ƒæ€')) {
                detailedFetishes.push({
                    name: 'åŸå§‹æ¸¸æˆ Primal Play',
                    intensity: 'ä¸­-é«˜',
                    desc: 'æ”¾ä¸‹æ–‡æ˜çš„æŸç¼šï¼Œå›å½’åŠ¨ç‰©æœ¬èƒ½ã€‚å¯èƒ½æ¶‰åŠè¿½é€ã€æ‰‘å’¬ã€æŠ“æŒ ã€å˜¶å¼ã€‚è¿™æ˜¯ä¸€ç§åŸå§‹çš„ã€é‡æ€§çš„äº’åŠ¨æ–¹å¼ï¼Œä¸éœ€è¦å¤æ‚çš„è§„åˆ™å’Œé“å…·ï¼Œåªéœ€è¦é‡Šæ”¾å†…å¿ƒçš„é‡å…½ã€‚',
                    tags: ['æœ¬èƒ½é‡Šæ”¾', 'é‡æ€§äº’åŠ¨', 'èº«ä½“æ¥è§¦']
                });
            }

            // 21. æ‹ç‰© Fetishism
            if (hasStar(fuDe, 'å¤ªé˜´') || hasStar(ming, 'å¤ªé˜´') || hasStar(ziNv, 'å¤ªé˜´') || hasStar(jiE, 'å¤ªé˜´') || hasStar(fuDe, 'å¤©æœº') || hasStar(ming, 'å¤©æœº')) {
                detailedFetishes.push({
                    name: 'æ‹ç‰© Fetishism',
                    intensity: 'è½»-ä¸­',
                    desc: 'å¯¹ç‰¹å®šç‰©å“æœ‰å¼ºçƒˆçš„æ€§å¸å¼•åŠ›ã€‚å¯èƒ½æ˜¯ä¸è¢œã€é«˜è·Ÿé‹ã€çš®é©ã€ä¹³èƒ¶ã€åˆ¶æœç­‰ã€‚è¿™äº›ç‰©å“æœ¬èº«å°±èƒ½æ¿€å‘ä½ çš„æ¬²æœ›ï¼Œç”šè‡³æ¯”èº«ä½“æœ¬èº«æ›´æœ‰å¸å¼•åŠ›ã€‚',
                    tags: ['ç‰©å“è¿·æ‹', 'è§†è§‰åˆºæ¿€', 'æè´¨åå¥½']
                });
            }

            // 22. ä¹³èƒ¶/çš®é© Latex/Leather
            if (hasStar(jiE, 'å»‰è´') || hasStar(fuDe, 'è´ªç‹¼') || hasStar(ming, 'å»‰è´') || hasStar(ziNv, 'å»‰è´') || hasStar(ming, 'è´ªç‹¼') || hasStar(ziNv, 'è´ªç‹¼')) {
                detailedFetishes.push({
                    name: 'ä¹³èƒ¶/çš®é© Latex/Leather',
                    intensity: 'è½»-ä¸­',
                    desc: 'å¯¹ä¹³èƒ¶è¡£ã€çš®é©è£…æœ‰ç‰¹åˆ«çš„è¿·æ‹ã€‚ç´§èº«çš„ä¹³èƒ¶åŒ…è£¹å…¨èº«çš„æ„Ÿè§‰ï¼Œçš®é©çš„æ°”å‘³å’Œè´¨æ„Ÿï¼Œéƒ½èƒ½å¸¦æ¥å¼ºçƒˆçš„æ„Ÿå®˜åˆºæ¿€ã€‚è¿™ä¹Ÿæ˜¯ä¸€ç§è§†è§‰ä¸Šçš„æƒåŠ›è±¡å¾ã€‚',
                    tags: ['æè´¨è¿·æ‹', 'ç´§èº«æŸç¼š', 'è§†è§‰å†²å‡»']
                });
            }

            // 23. è¶³éƒ¨å´‡æ‹œ Foot Worship
            if (hasStar(ming, 'ç´«å¾®') || hasStar(ziNv, 'å¤©ç›¸') || hasStar(fuDe, 'ç´«å¾®') || hasStar(ming, 'å¤©ç›¸') || hasStar(fuDe, 'å¤©ç›¸') || subScore >= 2) {
                detailedFetishes.push({
                    name: 'è¶³éƒ¨å´‡æ‹œ Foot Worship',
                    intensity: 'è½»',
                    desc: 'å¯¹è„šæœ‰ç‰¹åˆ«çš„è¿·æ‹ï¼Œäº«å—äº²å»ã€èˆ”èˆã€æŒ‰æ‘©å¯¹æ–¹çš„è„šã€‚è¿™æ˜¯ä¸€ç§è‡£æœçš„è±¡å¾â€”â€”èº«ä½“æœ€ä½çš„éƒ¨ä½æˆä¸ºå´‡æ‹œçš„å¯¹è±¡ã€‚å¯èƒ½å¯¹é«˜è·Ÿé‹ã€ä¸è¢œã€è„šè¶¾ã€è¶³å¼“æœ‰ç‰¹åˆ«çš„åå¥½ã€‚',
                    tags: ['èº«ä½“å´‡æ‹œ', 'è‡£æœè±¡å¾', 'æ„Ÿå®˜åå¥½']
                });
            }

            // 24. è·µè¸ Trampling
            if (masochScore >= 2 || (hasStar(jiE, 'å»‰è´') && subScore >= 2) || (hasStar(ziNv, 'ä¸ƒæ€') && subScore >= 2)) {
                detailedFetishes.push({
                    name: 'è·µè¸ Trampling',
                    intensity: 'ä¸­-é«˜',
                    desc: 'è¢«å¯¹æ–¹ç”¨è„šè¸©è¸èº«ä½“ï¼Œå¯èƒ½æ˜¯èµ¤è„šæˆ–ç©¿ç€é«˜è·Ÿé‹ã€‚è¿™æ˜¯ä¸€ç§æåº¦çš„ç¾è¾±å’Œè‡£æœï¼Œèº«ä½“è¢«å½“ä½œåœ°æ¿ä¸€æ ·å¯¹å¾…ã€‚ç–¼ç—›å’Œç¾è¾±æ„Ÿæ··åˆåœ¨ä¸€èµ·ï¼Œäº§ç”Ÿå¼ºçƒˆçš„å¿ƒç†å†²å‡»ã€‚',
                    tags: ['ç¾è¾±æ¸¸æˆ', 'ç–¼ç—›åˆºæ¿€', 'æåº¦è‡£æœ']
                });
            }

            // 25. CNC (Consensual Non-Consent)
            if (kScore >= 8 && (hasStar(ming, 'ç ´å†›') || hasStar(ming, 'ä¸ƒæ€') || hasStar(ziNv, 'ç ´å†›') || hasStar(ziNv, 'ä¸ƒæ€') || hasStar(fuDe, 'ç ´å†›') || hasStar(fuDe, 'ä¸ƒæ€'))) {
                detailedFetishes.push({
                    name: 'CNC åå•†éåŒæ„',
                    intensity: 'æé«˜',
                    desc: 'äº‹å…ˆåå•†å¥½çš„"å¼ºè¿«"åœºæ™¯ï¼Œæ¨¡æ‹Ÿéè‡ªæ„¿çš„æƒ…å¢ƒã€‚è¿™æ˜¯æœ€å…·äº‰è®®çš„æ¸¸æˆä¹‹ä¸€ï¼Œéœ€è¦æé«˜çš„ä¿¡ä»»ã€è¯¦ç»†çš„äº‹å‰åå•†å’Œæ˜ç¡®çš„å®‰å…¨è¯ã€‚è¿™ç§æ¸¸æˆè®©äººä½“éªŒå¤±å»æ§åˆ¶çš„ææƒ§å’Œåˆºæ¿€ï¼Œä½†ä¸€åˆ‡éƒ½åœ¨å®‰å…¨æ¡†æ¶å†…ã€‚',
                    tags: ['æé™åœºæ™¯', 'é«˜åº¦ä¿¡ä»»', 'è¯¦ç»†åå•†']
                });
            }

            // ç‰¹æ®Šç™–å¥½æ¨æµ‹ï¼ˆä¿ç•™åŸæœ‰çš„ç®€åŒ–ç‰ˆæœ¬ï¼‰
            const fetishItems = [];
            if (hasStar(ming, 'ä¸ƒæ€') || hasStar(ziNv, 'ä¸ƒæ€')) fetishItems.push({ label: 'æƒåŠ›æ¸¸æˆ Power Exchange', desc: 'å¯¹æƒåŠ›å·®å¼‚æœ‰å¼ºçƒˆå…´è¶£ï¼Œä¸»ä»å…³ç³»æœ¬èº«å°±æ˜¯æœ€å¤§çš„åˆºæ¿€ã€‚ä½ äº«å—é‚£ç§"æˆ‘è¯´äº†ç®—"æˆ–"ä½ è¯´äº†ç®—"çš„æ˜ç¡®æ„Ÿï¼Œæ¨¡ç³Šçš„æƒåŠ›å…³ç³»åè€Œè®©ä½ ä¸èˆ’æœã€‚å¯èƒ½å¯¹ä¸»ä»†ã€ä¸»å¥´ã€è€å¸ˆå­¦ç”Ÿç­‰å¸¦æœ‰æƒåŠ›è½å·®çš„åœºæ™¯æœ‰ç‰¹åˆ«çš„å¸å¼•åŠ›ã€‚è¿™ä¸åªæ˜¯è‚‰ä½“å±‚é¢çš„ï¼Œæ›´æ˜¯å¿ƒç†å±‚é¢çš„â€”â€”è°æŒæ§è°ï¼Œè°æœä»è°ï¼Œè¿™ä¸ªåŠ¨æ€æœ¬èº«å°±è®©ä½ å…´å¥‹ã€‚' });
            if (hasStar(ming, 'ç ´å†›') || hasStar(ziNv, 'ç ´å†›')) fetishItems.push({ label: 'ç¦å¿Œæ¢ç´¢ Taboo', desc: 'è¶Šæ˜¯ç¦å¿Œè¶Šæœ‰å¸å¼•åŠ›ï¼Œå–œæ¬¢çªç ´è¾¹ç•Œå’Œå¸¸è§„ã€‚ä½ å¯¹"ä¸åº”è¯¥"æœ‰å¤©ç„¶çš„å¥½å¥‡å¿ƒï¼Œç¤¾ä¼šè§„èŒƒå’Œé“å¾·è¾¹ç•Œå¯¹ä½ æ¥è¯´æ›´åƒæ˜¯æŒ‘æˆ˜è€Œä¸æ˜¯çº¦æŸã€‚å¯èƒ½å¯¹å…¬å…±åœºæ‰€ã€è§’è‰²æ‰®æ¼”ä¸­çš„ç¦å¿Œåœºæ™¯ã€æˆ–è€…æ‰“ç ´æŸç§"è§„åˆ™"çš„è¡Œä¸ºæœ‰ç‰¹åˆ«çš„å…´è¶£ã€‚è¿™ç§å…´å¥‹æ„Ÿæ¥è‡ªäºè¶Šç•Œæœ¬èº«â€”â€”ä¸æ˜¯å› ä¸ºä¸é“å¾·ï¼Œè€Œæ˜¯å› ä¸ºé‚£ç§"æˆ‘ä»¬åœ¨åšåˆ«äººä¸æ•¢åšçš„äº‹"çš„æ„Ÿè§‰ã€‚' });
            if (hasStar(fuDe, 'è´ªç‹¼') || hasStar(ziNv, 'è´ªç‹¼')) fetishItems.push({ label: 'å¤šå…ƒæ„Ÿå®˜ Sensory Play', desc: 'å¯¹å„ç§æ„Ÿå®˜åˆºæ¿€éƒ½æœ‰å…´è¶£ï¼Œå–œæ¬¢æ¢ç´¢ä¸åŒçš„ä½“éªŒæ–¹å¼ã€‚è§†è§‰ã€å¬è§‰ã€è§¦è§‰ã€å—…è§‰â€”â€”ä½ å¯¹æ„Ÿå®˜çš„å¼€æ”¾åº¦å¾ˆé«˜ï¼Œæ„¿æ„å°è¯•è’™çœ¼ã€å†°ç«ã€ç¾½æ¯›ã€èœ¡çƒ›ç­‰å„ç§æ„Ÿå®˜æ¸¸æˆã€‚ä½ çš„å¥½å¥‡å¿ƒé©±ä½¿ä½ ä¸æ–­æ¢ç´¢æ–°çš„åˆºæ¿€æ–¹å¼ï¼Œå•ä¸€çš„æ„Ÿå®˜ä½“éªŒå¾ˆå¿«å°±ä¼šè®©ä½ è§‰å¾—ä¸å¤Ÿã€‚ä½ å¯èƒ½å¯¹æƒ…è¶£ç”¨å“ã€ç‰¹æ®Šæè´¨çš„è¡£ç‰©æˆ–é“å…·æœ‰å¤©ç„¶çš„å…´è¶£ã€‚' });
            if (hasStar(ming, 'å»‰è´') || hasStar(ziNv, 'å»‰è´')) fetishItems.push({ label: 'æ¿€æƒ…ä¸å±é™©æ„Ÿ Edgeplay', desc: 'å¯¹å¸¦æœ‰ç´§å¼ æ„Ÿå’Œæ¿€æƒ…çš„åœºæ™¯æœ‰ç‰¹åˆ«çš„å¸å¼•åŠ›ã€‚ä½ å–œæ¬¢é‚£ç§å¿ƒè·³åŠ é€Ÿã€è‚¾ä¸Šè…ºç´ é£™å‡çš„æ„Ÿè§‰ï¼Œå®‰å…¨ä½†å¸¦æœ‰"å±é™©æ„Ÿ"çš„åœºæ™¯æœ€èƒ½æ¿€å‘ä½ ã€‚å¯èƒ½å¯¹çª’æ¯æ„Ÿã€å¼ºåº¦è¾ƒé«˜çš„æŸç¼šã€æˆ–è€…å¸¦æœ‰å¼ºçƒˆæƒ…ç»ªå†²çªçš„åœºæ™¯æœ‰å…´è¶£ã€‚ä½ éœ€è¦æ„Ÿå—åˆ°é‚£ç§"è¾¹ç¼˜æ„Ÿ"â€”â€”ä¸æ˜¯çœŸçš„å±é™©ï¼Œè€Œæ˜¯é‚£ç§ç«™åœ¨è¾¹ç¼˜çš„åˆºæ¿€ã€‚è¯·åŠ¡å¿…åœ¨å……åˆ†äº†è§£å®‰å…¨çŸ¥è¯†çš„å‰æä¸‹æ¢ç´¢è¿™ç±»ä½“éªŒã€‚' });
            if (hasStar(ming, 'å¤ªé˜´') || hasStar(ziNv, 'å¤ªé˜´')) fetishItems.push({ label: 'ç»†è…»è§¦æ„Ÿ Sensation Play', desc: 'å¯¹è§¦æ„Ÿå’Œç»†èŠ‚æä¸ºæ•æ„Ÿï¼Œè½»æŸ”çš„æ¥è§¦æœ‰æ—¶æ¯”æ¿€çƒˆçš„åŠ¨ä½œæ›´èƒ½è§¦åŠ¨ä½ ã€‚ä½ å¯èƒ½å¯¹ç‰¹å®šæè´¨æœ‰åå¥½â€”â€”ä¸ç»¸ã€çš®é©ã€è•¾ä¸ï¼Œæˆ–è€…ç‰¹å®šçš„è§¦ç¢°æ–¹å¼ã€‚ä½ çš„çš®è‚¤æ„Ÿå—åŠ›å¾ˆå¼ºï¼Œè½»æŠšã€æŒ‡å°–çš„è§¦ç¢°ã€ç”šè‡³å‘¼å¸çš„æ¸©åº¦éƒ½èƒ½è®©ä½ æœ‰å¼ºçƒˆçš„ååº”ã€‚è’™çœ¼ä¹‹åè§¦æ„Ÿä¼šè¢«æ”¾å¤§ï¼Œè¿™å¯¹ä½ æ¥è¯´å¯èƒ½æ˜¯éå¸¸å¼ºçƒˆçš„ä½“éªŒã€‚ä½ äº«å—é‚£ç§è¢«ç»†å¿ƒå¯¹å¾…ã€è¢«è®¤çœŸæ„Ÿå—çš„æ„Ÿè§‰ã€‚' });
            if (hasStar(fuDe, 'å¤©æœº') || hasStar(ming, 'å¤©æœº')) fetishItems.push({ label: 'å¿ƒç†åšå¼ˆ Mind Games', desc: 'äº«å—å¿ƒç†å±‚é¢çš„æ‹‰æ‰¯å’Œåšå¼ˆï¼Œæ™ºè¯†ä¸Šçš„å¸å¼•æ˜¯å‰æˆçš„ä¸€éƒ¨åˆ†ã€‚ä½ å¯¹å¿ƒç†æ§åˆ¶ã€è¯­è¨€æ¸¸æˆã€ç”šè‡³è½»å¾®çš„ç…¤æ°”ç¯æ•ˆåº”ï¼ˆåœ¨å®‰å…¨æ¡†æ¶å†…ï¼‰æœ‰å…´è¶£ã€‚ä½ å–œæ¬¢é‚£ç§"æˆ‘çŸ¥é“ä½ åœ¨æƒ³ä»€ä¹ˆ"çš„æ„Ÿè§‰ï¼Œä¹Ÿäº«å—è¢«å¯¹æ–¹çœ‹ç©¿çš„æ„Ÿè§‰ã€‚æ·±åº¦çš„å¿ƒç†äº’åŠ¨å¯¹ä½ æ¥è¯´æ¯”ä»»ä½•è‚‰ä½“åˆºæ¿€éƒ½æ›´æœ‰åŠ›é‡ã€‚ä½ å¯èƒ½å¯¹å‚¬çœ ã€å¿ƒç†æš—ç¤ºã€æˆ–è€…å¸¦æœ‰å¿ƒç†æ§åˆ¶å…ƒç´ çš„åœºæ™¯æœ‰ç‰¹åˆ«çš„å…´è¶£ã€‚' });
            if (hasStar(ming, 'ç´«å¾®') || hasStar(fuDe, 'ç´«å¾®')) fetishItems.push({ label: 'å´‡æ‹œä¸ä»ªå¼æ„Ÿ Worship', desc: 'å¯¹ä»ªå¼æ„Ÿå’Œè¢«å´‡æ‹œæœ‰éšç§˜çš„æ¸´æœ›ï¼Œå°Šä¸¥æ„Ÿæ˜¯é‡è¦çš„å…´å¥‹ç‚¹ã€‚ä½ å¯èƒ½äº«å—è¢«å¯¹æ–¹ä»¥æŸç§ä»ªå¼åŒ–çš„æ–¹å¼å¯¹å¾…â€”â€”è·ªæ‹œã€äº²å»ã€ç‰¹å®šçš„ç§°è°“ï¼Œè¿™äº›å½¢å¼æ„Ÿå¯¹ä½ æ¥è¯´ä¸æ˜¯è¡¨æ¼”ï¼Œè€Œæ˜¯çœŸå®çš„æƒåŠ›ç¡®è®¤ã€‚ä½ ä¹Ÿå¯èƒ½äº«å—å´‡æ‹œå¯¹æ–¹çš„æ„Ÿè§‰â€”â€”æŠŠå¯¹æ–¹å½“æˆç¥æ˜ä¸€æ ·ä¾›å¥‰ï¼Œè¿™ç§æåº¦çš„ä»°è§†æœ¬èº«å°±æ˜¯ä¸€ç§æ»¡è¶³ã€‚ä»ªå¼æ„Ÿè®©äº²å¯†å…³ç³»æœ‰äº†æŸç§ç¥åœ£æ€§ï¼Œè¿™å¯¹ä½ å¾ˆé‡è¦ã€‚' });
            if (hasStar(jiE, 'è´ªç‹¼') || hasStar(jiE, 'å»‰è´')) fetishItems.push({ label: 'æŒä¹…ä¸è€åŠ› Endurance', desc: 'ä½“èƒ½æ—ºç››ï¼Œäº«å—é•¿æ—¶é—´çš„äº²å¯†äº’åŠ¨ï¼Œä¸å–œæ¬¢è‰è‰äº†äº‹ã€‚ä½ å¯èƒ½å¯¹é©¬æ‹‰æ¾å¼çš„äº²å¯†å…³ç³»æœ‰ç‰¹åˆ«çš„å…´è¶£ï¼Œäº«å—é‚£ç§è¢«æ…¢æ…¢æ¶ˆè€—ã€é€æ¸è¾¾åˆ°æé™çš„æ„Ÿè§‰ã€‚é•¿æ—¶é—´çš„å‰æˆã€åå¤çš„é«˜æ½®ã€æˆ–è€…åˆ»æ„å»¶è¿Ÿæ»¡è¶³â€”â€”è¿™äº›å¯¹ä½ æ¥è¯´éƒ½æ˜¯äº«å—è€Œä¸æ˜¯æŠ˜ç£¨ã€‚ä½ çš„èº«ä½“è€å—åŠ›å¼ºï¼Œä¹Ÿäº«å—æµ‹è¯•è‡ªå·±å’Œå¯¹æ–¹çš„æé™ã€‚' });
            if (hasStar(fuDe, 'ç ´å†›')) fetishItems.push({ label: 'å¤±æ§ä¸é‡Šæ”¾ Catharsis', desc: 'äº«å—å®Œå…¨æ”¾å¼€ã€å¤±å»æ§åˆ¶çš„æ„Ÿè§‰ï¼ŒæŸç¼šå’Œé‡Šæ”¾éƒ½èƒ½å¸¦æ¥å¿«æ„Ÿã€‚ä½ å†…å¿ƒæ·±å¤„æœ‰ä¸€ç§æ¸´æœ›â€”â€”å½»åº•æ”¾ä¸‹æ‰€æœ‰çš„ç†æ€§å’Œæ§åˆ¶ï¼Œè®©è‡ªå·±å®Œå…¨æ²‰æµ¸åœ¨æ„Ÿå—é‡Œã€‚è¿™ç§"å¤±æ§"å¯¹ä½ æ¥è¯´æ˜¯ä¸€ç§æ·±å±‚çš„é‡Šæ”¾ï¼Œæ—¥å¸¸ç”Ÿæ´»ä¸­ä½ å¯èƒ½æ‰¿æ‹…äº†å¤ªå¤šè´£ä»»å’Œæ§åˆ¶ï¼Œäº²å¯†å…³ç³»æ˜¯ä½ å”¯ä¸€å¯ä»¥æ”¾ä¸‹ä¸€åˆ‡çš„åœ°æ–¹ã€‚å“­æ³£ã€é¢¤æŠ–ã€å®Œå…¨çš„æƒ…ç»ªé‡Šæ”¾â€”â€”è¿™äº›åœ¨äº²å¯†å…³ç³»ä¸­å¯¹ä½ æ¥è¯´éƒ½æ˜¯æ­£å¸¸ä¸”çè´µçš„ä½“éªŒã€‚' });
            if (hasStar(ming, 'å¤©ç›¸') || hasStar(ziNv, 'å¤©ç›¸')) fetishItems.push({ label: 'æœåŠ¡ä¸å–æ‚¦ Service', desc: 'ä½ æœ‰å¼ºçƒˆçš„å–æ‚¦æ¬²ï¼Œäº«å—è®©å¯¹æ–¹æ»¡è¶³çš„è¿‡ç¨‹ã€‚çœ‹åˆ°å¯¹æ–¹å› ä¸ºä½ è€Œæ„Ÿåˆ°æ„‰æ‚¦ï¼Œå¯¹ä½ æ¥è¯´æ˜¯ä¸€ç§æ·±å±‚çš„æ»¡è¶³æ„Ÿã€‚ä½ å¯èƒ½å¯¹"æœåŠ¡å‹ Sub"çš„è§’è‰²æœ‰å¤©ç„¶çš„äº²è¿‘æ„Ÿâ€”â€”ä¸æ˜¯å› ä¸ºè½¯å¼±ï¼Œè€Œæ˜¯å› ä¸ºä½ çœŸå¿ƒäº«å—ç…§é¡¾å’Œå–æ‚¦å¯¹æ–¹ã€‚ä½ çš„æ»¡è¶³æ„Ÿå¾ˆå¤§ç¨‹åº¦ä¸Šæ¥è‡ªäºå¯¹æ–¹çš„ååº”ï¼Œå¯¹æ–¹è¶ŠæŠ•å…¥ï¼Œä½ è¶Šå…´å¥‹ã€‚' });
            if (fetishItems.length === 0) fetishItems.push({ label: 'ç»å…¸åå¥½ Classic', desc: 'æ²¡æœ‰ç‰¹åˆ«çªå‡ºçš„ç‰¹æ®Šç™–å¥½ï¼Œåå¥½ä¼ ç»Ÿã€ç›´æ¥çš„äº²å¯†æ–¹å¼ã€‚è¿™ä¸ä»£è¡¨ä½ æ— èŠâ€”â€”ç»å…¸çš„æ–¹å¼ä¹‹æ‰€ä»¥ç»å…¸ï¼Œæ˜¯å› ä¸ºå®ƒçœŸçš„æœ‰æ•ˆã€‚ä½ æ›´çœ‹é‡çš„æ˜¯åŒæ–¹çš„åŒ–å­¦ååº”å’Œæƒ…æ„Ÿè¿æ¥ï¼Œè€Œä¸æ˜¯å½¢å¼ä¸Šçš„æ–°å¥‡ã€‚åœ¨è¶³å¤Ÿä¿¡ä»»çš„å…³ç³»é‡Œï¼Œä½ å¯èƒ½ä¼šé€æ¸å¼€æ”¾ï¼Œå°è¯•ä¸€äº›ä¹‹å‰æ²¡æƒ³è¿‡çš„ä½“éªŒã€‚' });

            // â”€â”€ ç»„è£… HTML â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
            const nameDisplay = username ? `${username} çš„` : 'ä½ çš„';
            let html = `<div class="result-card-wrap" id="shareCard">`;
            html += `<div class="username-display">${username || 'åŒ¿å'}</div>`;
            html += `<div class="result-title">${nameDisplay}æ€§åå¥½å›¾è°±</div>`;
            html += `<p class="result-subtitle">åŸºäºå‘½ç›˜æ¨ç®— Â· ä»…ä¾›å¨±ä¹å‚è€ƒ</p>`;

            // æ ‡ç­¾è¡Œ
            html += `<div class="tag-row">`;
            const desireTagClass = desireBar >= 70 ? 'tag-strong' : desireBar >= 50 ? 'tag-medium' : 'tag-soft';
            html += `<span class="tag ${desireTagClass}">æ¬²æœ› ${desireLevel}</span>`;
            html += `<span class="tag ${roleTagClass}">${roleTag}</span>`;
            html += `<span class="tag tag-passive">${bdsmRole}</span>`;
            styleItems.slice(0, 1).forEach(s => {
                html += `<span class="tag tag-balance">${s.icon} ${s.text.split('ï¼Œ')[0]}</span>`;
            });
            html += `</div>`;

            // æ¬²æœ›å¼ºåº¦å¡ç‰‡
            html += `<div class="card">
                <div class="card-header">
                    <div class="card-icon" style="background:rgba(255,100,100,0.15);">ğŸŒ¡ï¸</div>
                    <div class="card-title">æ¬²æœ›å¼ºåº¦</div>
                </div>
                <div class="meter-row">
                    <span class="meter-label">å¼ºåº¦</span>
                    <div class="meter-bar"><div class="meter-fill" style="width:${desireBar}%"></div></div>
                    <span class="meter-value">${desireLevel}</span>
                </div>
                <div class="card-body">${desireText}</div>
            </div>`;

            // ä¸»è¢«åŠ¨å¡ç‰‡
            html += `<div class="card">
                <div class="card-header">
                    <div class="card-icon" style="background:rgba(100,150,255,0.15);">âš–ï¸</div>
                    <div class="card-title">ä¸»è¢«åŠ¨å€¾å‘ Â· ${roleTag}</div>
                </div>
                <div class="card-body">${roleText}</div>
            </div>`;

            // BDSM å¡ç‰‡
            html += `<div class="card">
                <div class="card-header">
                    <div class="card-icon" style="background:rgba(180,0,255,0.15);">ğŸ”—</div>
                    <div class="card-title">BDSM å€¾å‘</div>
                </div>
                <div class="card-body">
                    <div style="margin-bottom:16px;">
                        <div style="font-weight:700;color:#c9a0ff;font-size:16px;margin-bottom:6px;">${bdsmRole}</div>
                        <div style="line-height:1.8;">${bdsmRoleDesc}</div>
                    </div>
                </div>
            </div>`;

            // Kçº§åˆ†ç±»å¡ç‰‡
            html += `<div class="card">
                <div class="card-header">
                    <div class="card-icon" style="background:rgba(218,165,32,0.2);">ğŸ“Š</div>
                    <div class="card-title">Kçº§åˆ†ç±» Â· BDSMå¼ºåº¦è¯„ä¼°</div>
                </div>
                <div class="card-body">
                    <div style="text-align:center;margin-bottom:20px;">
                        <div style="display:inline-block;padding:12px 32px;background:${kLevelColor};border-radius:16px;margin-bottom:12px;">
                            <span style="font-size:32px;font-weight:900;color:white;text-shadow:0 2px 8px rgba(0,0,0,0.3);">${kLevel}</span>
                        </div>
                        <div style="font-size:13px;opacity:0.6;margin-top:8px;">K1(æ— å€¾å‘) â†’ K9(æé‡åº¦)</div>
                    </div>
                    <div style="line-height:1.8;font-size:14px;margin-bottom:16px;">${kLevelDesc}</div>
                    <div style="background:rgba(255,255,255,0.05);padding:12px;border-radius:8px;border-left:3px solid ${kLevelColor};">
                        <div style="font-size:12px;opacity:0.7;line-height:1.6;">
                            <strong>Kçº§è¯´æ˜ï¼š</strong>Kçº§åˆ†ç±»ç³»ç»Ÿå‚è€ƒé‡‘èµ›é‡è¡¨ï¼Œå°†BDSMå€¾å‘ä»K1åˆ°K9åˆ†ä¸º9ä¸ªç­‰çº§ã€‚è¿™ä¸æ˜¯é“å¾·è¯„åˆ¤ï¼Œåªæ˜¯æè¿°ä½ çš„åå¥½å¼ºåº¦ã€‚æ¯ä¸ªäººéƒ½æœ‰æƒåˆ©æ¢ç´¢è‡ªå·±çš„æ€§åå¥½ï¼Œå…³é”®æ˜¯å®‰å…¨ã€çŸ¥æƒ…åŒæ„å’Œç›¸äº’å°Šé‡ã€‚
                        </div>
                    </div>
                </div>
            </div>`;

            // è¯¦ç»†ç™–å¥½åˆ†ç±»å¡ç‰‡
            if (detailedFetishes.length > 0) {
                html += `<div class="card">
                    <div class="card-header">
                        <div class="card-icon" style="background:rgba(218,165,32,0.2);">ğŸ­</div>
                        <div class="card-title">å°ä¼—ç™–å¥½æ¨æµ‹ Â· å…±${detailedFetishes.length}é¡¹</div>
                    </div>
                    <div class="card-body">
                        <div style="font-size:13px;opacity:0.6;margin-bottom:16px;line-height:1.6;">
                            æ ¹æ®ä½ çš„å‘½ç›˜é…ç½®ï¼Œä»¥ä¸‹æ˜¯å¯èƒ½å¼•èµ·ä½ å…´è¶£çš„å°ä¼—ç™–å¥½ã€‚è¿™äº›æ¨æµ‹åŸºäºæ˜Ÿæ›œç»„åˆï¼Œä»…ä¾›å‚è€ƒã€‚å®é™…åå¥½å› äººè€Œå¼‚ï¼Œè¯·åœ¨å……åˆ†äº†è§£å®‰å…¨çŸ¥è¯†å’Œè·å¾—ä¼´ä¾£åŒæ„çš„å‰æä¸‹æ¢ç´¢ã€‚
                        </div>`;

                detailedFetishes.forEach((fetish, idx) => {
                    const intensityColor =
                        fetish.intensity.includes('æé«˜') ? '#DAA520' :
                        fetish.intensity.includes('é«˜') ? '#D4AF37' :
                        fetish.intensity.includes('ä¸­') ? '#E6C285' : '#EFCD9C';

                    html += `<div style="margin-bottom:${idx < detailedFetishes.length - 1 ? '20px' : '0'};padding-bottom:${idx < detailedFetishes.length - 1 ? '20px' : '0'};border-bottom:${idx < detailedFetishes.length - 1 ? '1px solid rgba(255,255,255,0.1)' : 'none'};">
                        <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:8px;">
                            <div style="font-weight:700;font-size:15px;color:#FFD700;">${fetish.name}</div>
                            <span style="padding:3px 10px;background:${intensityColor};color:white;border-radius:8px;font-size:11px;font-weight:600;">${fetish.intensity}</span>
                        </div>
                        <div style="font-size:13px;line-height:1.7;opacity:0.85;margin-bottom:8px;">${fetish.desc}</div>
                        <div style="display:flex;gap:6px;flex-wrap:wrap;">
                            ${fetish.tags.map(tag => `<span style="padding:2px 8px;background:rgba(218,165,32,0.2);border-radius:6px;font-size:11px;color:rgba(255,215,0,0.8);border:1px solid rgba(218,165,32,0.3);">${tag}</span>`).join('')}
                        </div>
                    </div>`;
                });

                html += `</div></div>`;
            }

            // é£æ ¼åå¥½å¡ç‰‡
            html += `<div class="card">
                <div class="card-header">
                    <div class="card-icon" style="background:rgba(100,255,150,0.15);">âœ¨</div>
                    <div class="card-title">é£æ ¼åå¥½</div>
                </div>
                <div class="card-body">`;
            styleItems.forEach((s, idx) => {
                html += `<div style="margin-bottom:${idx < styleItems.length - 1 ? '16px' : '0'};">
                    <div style="font-size:20px;margin-bottom:6px;">${s.icon}</div>
                    <div style="line-height:1.8;font-size:14px;">${s.text}</div>
                </div>`;
            });
            html += `</div></div>`;

            // ç‰¹æ®Šç™–å¥½å¡ç‰‡
            html += `<div class="card">
                <div class="card-header">
                    <div class="card-icon" style="background:rgba(255,180,0,0.15);">ğŸŒ¶ï¸</div>
                    <div class="card-title">ç™–å¥½æ¨æµ‹</div>
                </div>
                <div class="card-body">`;
            fetishItems.forEach((f, idx) => {
                html += `<div style="margin-bottom:${idx < fetishItems.length - 1 ? '16px' : '0'};">
                    <div style="font-weight:700;color:#ffd699;margin-bottom:6px;font-size:15px;">${f.label}</div>
                    <div style="line-height:1.8;font-size:14px;">${f.desc}</div>
                </div>`;
            });
            html += `</div></div>`;

            // ä¼´ä¾£åå¥½å¡ç‰‡
            html += `<div class="card">
                <div class="card-header">
                    <div class="card-icon" style="background:rgba(255,150,100,0.15);">ğŸ’‘</div>
                    <div class="card-title">ä¼´ä¾£åå¥½</div>
                </div>
                <div class="card-body">`;
            partnerItems.forEach(p => {
                html += `<div style="margin-bottom:14px;">
                    <div style="font-weight:700;color:#e0c8ff;margin-bottom:4px;">â–¸ ${p.trait}</div>
                    <div style="font-size:14px;line-height:1.7;opacity:0.85;">${p.desc}</div>
                </div>`;
            });
            html += `</div></div>`;

            // åŠ æˆé¡¹
            if (bonusItems.length > 0) {
                html += `<div class="card">
                    <div class="card-header">
                        <div class="card-icon" style="background:rgba(255,255,100,0.15);">â­</div>
                        <div class="card-title">å¤©èµ‹åŠ æˆ</div>
                    </div>
                    <div class="card-body">`;
                bonusItems.forEach(b => { html += `<div style="margin-bottom:8px;">Â· ${b}</div>`; });
                html += `</div></div>`;
            }

            // æ³¨æ„äº‹é¡¹
            if (cautionItems.length > 0) {
                html += `<div class="note-box">âš ï¸ <b>æ³¨æ„äº‹é¡¹</b><br><br>`;
                cautionItems.forEach(c => { html += `Â· ${c}<br><br>`; });
                html += `</div>`;
            }

            html += `</div>`; // å…³é—­ result-card-wrap

            return html;
        }

        // ä¸»åˆ†æå‡½æ•°
        function analyze() {
            const calendarType = document.getElementById('calendarType').value;
            const year = parseInt(document.getElementById('year').value);
            const month = parseInt(document.getElementById('month').value);
            const day = parseInt(document.getElementById('day').value);
            const hourVal = parseInt(document.getElementById('hour').value);
            const gender = document.getElementById('gender').value;
            const username = document.getElementById('username').value.trim();

            if (!year || !month || !day) {
                alert('è¯·å¡«å†™å®Œæ•´çš„å‡ºç”Ÿæ—¥æœŸ');
                return;
            }

            let lunarDate;
            if (calendarType === 'solar') {
                lunarDate = ZiWei.solarToLunar(year, month, day);
            } else {
                lunarDate = { year, month, day };
            }

            const hour = hourVal === -1 ? 12 : hourVal;
            const hourUnknown = hourVal === -1;

            const chart = ZiWei.paipan(lunarDate.year, lunarDate.month, lunarDate.day, hour, gender);

            let html = analyzePreference(chart, gender, username);

            if (hourUnknown) {
                html += `<div class="note-box" style="margin-top:0;border-radius:0 0 20px 20px;">â° æ—¶è¾°æœªçŸ¥ï¼Œä»¥åˆæ—¶æ¨ç®—ï¼Œå‘½å®«åˆ¤æ–­å¯èƒ½æœ‰åå·®ã€‚</div>`;
            }

            // åˆ†äº«/ä¿å­˜æŒ‰é’®
            html += `<div class="share-bar">
                <button class="btn-save" onclick="saveAsImage()">ğŸ“¥ ä¿å­˜ä¸ºå›¾ç‰‡</button>
                <button class="btn-copy" onclick="copyResult()">ğŸ“‹ å¤åˆ¶æ–‡å­—ç»“æœ</button>
            </div>`;

            document.getElementById('resultContent').innerHTML = html;
            document.getElementById('resultSection').classList.add('show');
            document.getElementById('resultSection').scrollIntoView({ behavior: 'smooth' });
        }

        // ä¿å­˜ä¸ºå›¾ç‰‡ï¼ˆä½¿ç”¨ html2canvasï¼‰
        function saveAsImage() {
            const card = document.getElementById('shareCard');
            if (!card) return;
            if (typeof html2canvas === 'undefined') {
                alert('æ­£åœ¨åŠ è½½æˆªå›¾åº“ï¼Œè¯·ç¨åå†è¯•...');
                loadHtml2Canvas(saveAsImage);
                return;
            }
            html2canvas(card, { scale: 2, useCORS: true, backgroundColor: null }).then(canvas => {
                const link = document.createElement('a');
                const name = document.getElementById('username').value.trim() || 'æ€§åå¥½æµ‹è¯•';
                link.download = `${name}çš„æ€§åå¥½å›¾è°±.png`;
                link.href = canvas.toDataURL('image/png');
                link.click();
            });
        }

        // å¤åˆ¶æ–‡å­—ç»“æœ
        function copyResult() {
            const card = document.getElementById('shareCard');
            if (!card) return;
            const text = card.innerText;
            navigator.clipboard.writeText(text).then(() => {
                alert('å·²å¤åˆ¶åˆ°å‰ªè´´æ¿ï¼Œå¯ä»¥ç›´æ¥ç²˜è´´åˆ†äº«ç»™æœ‹å‹ ğŸ‰');
            }).catch(() => {
                // é™çº§æ–¹æ¡ˆ
                const ta = document.createElement('textarea');
                ta.value = text;
                document.body.appendChild(ta);
                ta.select();
                document.execCommand('copy');
                document.body.removeChild(ta);
                alert('å·²å¤åˆ¶åˆ°å‰ªè´´æ¿ ğŸ‰');
            });
        }

        // æ‡’åŠ è½½ html2canvas
        function loadHtml2Canvas(callback) {
            const s = document.createElement('script');
            s.src = 'https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js';
            s.onload = callback;
            document.head.appendChild(s);
        }

        // é¢„åŠ è½½ html2canvas
        loadHtml2Canvas(() => {});
    </script>
</body>
</html>